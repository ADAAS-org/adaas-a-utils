import {A_Feature,A_Inject,A_Scope,A_Error,A_Dependency,A_Concept,A_Container,A_TypeGuards,A_Component,A_IdentityHelper,A_Context,A_FormatterHelper,A_CONSTANTS__DEFAULT_ENV_VARIABLES_ARRAY,A_Entity,A_Fragment,A_Meta,A_ScopeError,A_CommonHelper}from'@adaas/a-concept';import {A_Frame}from'@adaas/a-frame';var pt=Object.defineProperty;var Pt=Object.getOwnPropertyDescriptor;var i=(re,t)=>pt(re,"name",{value:t,configurable:true});var a=(re,t,e,r)=>{for(var o=r>1?void 0:r?Pt(t,e):t,n=re.length-1,s;n>=0;n--)(s=re[n])&&(o=(r?s(t,e,o):s(o))||o);return r&&o&&pt(t,e,o),o},l=(re,t)=>(e,r)=>t(e,r,re);var R=class extends A_Fragment{constructor(t,e){super({name:t}),this._meta=new A_Meta;for(let r in e)this._meta.set(r,e[r]);}[Symbol.iterator](){return this._meta[Symbol.iterator]()}get meta(){return this._meta}get(t){return this._meta.get(t)}set(t,e){return this._meta.set(t,e),this}has(t){return this._meta.has(t)}drop(t){this._meta.delete(t);}clear(){return this._meta.clear(),this}toRaw(){return this._meta.toJSON()}toJSON(){return {name:this.name,...this.meta.toJSON()}}};i(R,"A_ExecutionContext"),R=a([A_Frame.Fragment({namespace:"A-Utils",name:"A-ExecutionContext",description:"Execution context fragment that provides a structured way to manage metadata and serialized data for execution environments. It allows storing and retrieving key-value pairs, facilitating context-aware operations within the application. It useful in cases when it's necessary to share some runtime data across multiple steps of thee features, or components."})],R);var d=class extends R{constructor(t,e){super("operation-context"),this.meta.set("name",t),this.meta.set("params",e||{});}get name(){return this._meta.get("name")||this._name}get result(){return this._meta.get("result")}get error(){return this._meta.get("error")}get params(){return this._meta.get("params")||{}}fail(t){this._meta.set("error",t);}succeed(t){this._meta.set("result",t);}toJSON(){return {name:this.name,params:this.params,result:this.result||{},error:this.error?.toJSON()}}};i(d,"A_OperationContext"),d=a([A_Frame.Fragment({namespace:"A-Utils",name:"A-OperationContext",description:"Operation execution context that encapsulates the metadata and serialized data related to a specific operation. It provides structured access to operation parameters, results, and error handling, facilitating the management of operation lifecycles within the application."})],d);var xe=class xe extends A_Error{constructor(t,e){A_TypeGuards.isString(e)?super(t,e):super(t),e instanceof d&&(this._context=e);}get context(){return this._context}};i(xe,"A_ChannelError"),xe.MethodNotImplemented="A-Channel Method Not Implemented";var oe=xe;var kt=(u=>(u.onTimeout="_A_Channel_onTimeout",u.onRetry="_A_Channel_onRetry",u.onCircuitBreakerOpen="_A_Channel_onCircuitBreakerOpen",u.onCache="_A_Channel_onCache",u.onConnect="_A_Channel_onConnect",u.onDisconnect="_A_Channel_onDisconnect",u.onBeforeRequest="_A_Channel_onBeforeRequest",u.onRequest="_A_Channel_onRequest",u.onAfterRequest="_A_Channel_onAfterRequest",u.onError="_A_Channel_onError",u.onSend="_A_Channel_onSend",u.onConsume="_A_Channel_onConsume",u))(kt||{}),Mt=(r=>(r.PENDING="PENDING",r.SUCCESS="SUCCESS",r.FAILED="FAILED",r))(Mt||{});var H=class extends d{constructor(t){super("request",t);}get status(){return this.result?.status}get data(){return this.result?.data}succeed(t){let e=this.result;super.succeed({...e,data:t,status:"SUCCESS"});}};i(H,"A_ChannelRequest"),H=a([A_Frame.Fragment({name:"A-ChannelRequest",description:"Context for managing channel requests. It encapsulates the request parameters and the result including status and data."})],H);var I=class extends A_Component{constructor(){super();this._processing=false;this._cache=new Map;}get processing(){return this._processing}get initialize(){return this._initialized||(this._initialized=this.connect()),this._initialized}async onConnect(...e){}async onDisconnect(...e){}async onBeforeRequest(...e){}async onRequest(...e){}async onAfterRequest(...e){}async onError(...e){}async onSend(...e){}async connect(){await this.call("_A_Channel_onConnect");}async disconnect(){await this.call("_A_Channel_onDisconnect");}async request(e){await this.initialize,this._processing=true;let r=new A_Scope({name:`a-channel@scope:request:${A_IdentityHelper.generateTimeId()}`}).inherit(A_Context.scope(this)),o=new H(e);try{return r.register(o),await this.call("_A_Channel_onBeforeRequest",r),await this.call("_A_Channel_onRequest",r),await this.call("_A_Channel_onAfterRequest",r),this._processing=!1,o}catch(n){this._processing=false;let s=new oe(n);throw o.fail(s),r.register(s),await this.call("_A_Channel_onError",r),r.destroy(),s}}async send(e){await this.initialize,this._processing=true;let r=new A_Scope({name:`a-channel@scope:send:${A_IdentityHelper.generateTimeId()}`}).inherit(A_Context.scope(this)),o=new d("send",e);try{r.inherit(A_Context.scope(this)),r.register(o),await this.call("_A_Channel_onSend",r),this._processing=!1;}catch(n){this._processing=false;let s=new oe(n);r.register(s),o.fail(s),await this.call("_A_Channel_onError",r),r.destroy();}}async consume(){await this.initialize,this._processing=true;let e=new A_Scope({name:`a-channel@scope:consume:${A_IdentityHelper.generateTimeId()}`}).inherit(A_Context.scope(this)),r=new d("consume",{});try{return e.inherit(A_Context.scope(this)),e.register(r),await this.call("_A_Channel_onConsume",e),this._processing=!1,r}catch(o){this._processing=false;let n=new oe(o);return r.fail(n),await this.call("_A_Channel_onError",e),r}}};i(I,"A_Channel"),a([A_Feature.Extend({name:"_A_Channel_onConnect"})],I.prototype,"onConnect",1),a([A_Feature.Extend({name:"_A_Channel_onDisconnect"})],I.prototype,"onDisconnect",1),a([A_Feature.Extend({name:"_A_Channel_onBeforeRequest"})],I.prototype,"onBeforeRequest",1),a([A_Feature.Extend({name:"_A_Channel_onRequest"})],I.prototype,"onRequest",1),a([A_Feature.Extend({name:"_A_Channel_onAfterRequest"})],I.prototype,"onAfterRequest",1),a([A_Feature.Extend({name:"_A_Channel_onError"})],I.prototype,"onError",1),a([A_Feature.Extend({name:"_A_Channel_onSend"})],I.prototype,"onSend",1),I=a([A_Frame.Namespace("A-Utils"),A_Frame.Component({name:"A-Channel",description:"Component uses as abstract channel for communication patterns. Can be inherited and extended to implement custom channels."})],I);var $t=(s=>(s.CREATED="CREATED",s.INITIALIZED="INITIALIZED",s.COMPILED="COMPILED",s.EXECUTING="EXECUTING",s.COMPLETED="COMPLETED",s.FAILED="FAILED",s))($t||{}),Ft=(o=>(o.CREATED_TO_INITIALIZED="created_initialized",o.INITIALIZED_TO_EXECUTING="initialized_executing",o.EXECUTING_TO_COMPLETED="executing_completed",o.EXECUTING_TO_FAILED="executing_failed",o))(Ft||{}),Yt=(c=>(c.onInit="_A_Command_onInit",c.onBeforeExecute="_A_Command_onBeforeExecute",c.onExecute="_A_Command_onExecute",c.onAfterExecute="_A_Command_onAfterExecute",c.onComplete="_A_Command_onComplete",c.onFail="_A_Command_onFail",c.onError="_A_Command_onError",c))(Yt||{}),zt=(c=>(c.onInit="onInit",c.onBeforeExecute="onBeforeExecute",c.onExecute="onExecute",c.onAfterExecute="onAfterExecute",c.onComplete="onComplete",c.onFail="onFail",c.onError="onError",c))(zt||{});var ie=class ie extends A_Error{};i(ie,"A_CommandError"),ie.CommandScopeBindingError="A-Command Scope Binding Error",ie.ExecutionError="A-Command Execution Error",ie.ResultProcessingError="A-Command Result Processing Error",ie.CommandInterruptedError="A-Command Interrupted Error";var q=ie;var ye=class ye extends A_Error{};i(ye,"A_StateMachineError"),ye.InitializationError="A-StateMachine Initialization Error",ye.TransitionError="A-StateMachine Transition Error";var pe=ye;var Ht=(o=>(o.onError="_A_StateMachine_onError",o.onInitialize="_A_StateMachine_onInitialize",o.onBeforeTransition="_A_StateMachine_onBeforeTransition",o.onAfterTransition="_A_StateMachine_onAfterTransition",o))(Ht||{});var P=class extends d{constructor(t){super("a-state-machine-transition",t),this._meta.set("from",t.from),this._meta.set("to",t.to);}get from(){return this._meta.get("from")}get to(){return this._meta.get("to")}};i(P,"A_StateMachineTransition"),P=a([A_Frame.Fragment({name:"A-StateMachineTransition",description:"Context for managing state machine transitions."})],P);var Jt,Xt,Zt,Qt,E=class extends A_Component{get ready(){return this._initialized||(this._initialized=this.call("_A_StateMachine_onInitialize")),this._initialized}async[Qt="_A_StateMachine_onInitialize"](...t){}async[Zt="_A_StateMachine_onBeforeTransition"](...t){}async[Xt="_A_StateMachine_onAfterTransition"](...t){}async[Jt="_A_StateMachine_onError"](...t){}async transition(t,e,r){await this.ready;let o=`${A_FormatterHelper.toCamelCase(String(t))}_${A_FormatterHelper.toCamelCase(String(e))}`,n=new P({from:String(t),to:String(e),props:r}),s=new A_Scope({name:`A-StateMachine-Transition-Scope-${o}`,fragments:[n]}).inherit(A_Context.scope(this));try{return await this.call("_A_StateMachine_onBeforeTransition",s),await this.call(o,s),await this.call("_A_StateMachine_onAfterTransition",s),s.destroy(),n.result}catch(c){let p=new pe({title:pe.TransitionError,description:`An error occurred while transitioning to "${o}"`,originalError:c});throw s.register(p),await this.call("_A_StateMachine_onError",s),s.destroy(),p}}};i(E,"A_StateMachine"),a([A_Feature.Extend()],E.prototype,Qt,1),a([A_Feature.Extend()],E.prototype,Zt,1),a([A_Feature.Extend()],E.prototype,Xt,1),a([A_Feature.Extend()],E.prototype,Jt,1),a([A_Frame.Method({name:"transition",description:"Executes a state transition from one state to another."})],E.prototype,"transition",1),E=a([A_Frame.Namespace("A-Utils"),A_Frame.Component({name:"A-StateMachine",description:"A powerful state machine component for managing complex state transitions."})],E);var zn={},_e=[];var we=class we extends A_Error{};i(we,"A_ConfigError"),we.InitializationError="A-Config Initialization Error";var B=we;var h=class extends R{constructor(e){super("a-config");this.DEFAULT_ALLOWED_TO_READ_PROPERTIES=[...A_CONSTANTS__DEFAULT_ENV_VARIABLES_ARRAY,..._e];this._strict=e.strict??false,this._configProperties=e.variables??[];for(let r in e.defaults)this.set(A_FormatterHelper.toUpperSnakeCase(r),e.defaults[r]);}get strict(){return this._strict}get(e){if(this._configProperties.includes(e)||this.DEFAULT_ALLOWED_TO_READ_PROPERTIES.includes(e)||!this._strict)return super.get(A_FormatterHelper.toUpperSnakeCase(e));throw new B("Property not exists or not allowed to read")}set(e,r){let o=Array.isArray(e)?e:typeof e=="string"?[{property:e,value:r}]:Object.keys(e).map(n=>({property:n,value:e[n]}));for(let{property:n,value:s}of o)super.set(A_FormatterHelper.toUpperSnakeCase(n),s);}};i(h,"A_Config"),h=a([A_Frame.Fragment({namespace:"A-Utils",name:"A-Config",description:"Configuration management context that provides structured access to application configuration variables, supporting defaults and strict mode for enhanced reliability. Default environment variables are included for comprehensive configuration handling."})],h);var dt=20,ti="all",ut={red:"31",yellow:"33",green:"32",blue:"34",cyan:"36",magenta:"35",gray:"90",brightBlue:"94",brightCyan:"96",brightMagenta:"95",darkGray:"30",lightGray:"37",indigo:"38;5;54",violet:"38;5;93",purple:"38;5;129",lavender:"38;5;183",skyBlue:"38;5;117",steelBlue:"38;5;67",slateBlue:"38;5;62",deepBlue:"38;5;18",lightBlue:"38;5;153",periwinkle:"38;5;111",cornflower:"38;5;69",powder:"38;5;152",charcoal:"38;5;236",silver:"38;5;250",smoke:"38;5;244",slate:"38;5;240"},gt=["blue","cyan","magenta","gray","brightBlue","brightCyan","brightMagenta","darkGray","lightGray","indigo","violet","purple","lavender","skyBlue","steelBlue","slateBlue","deepBlue","lightBlue","periwinkle","cornflower","powder","charcoal","silver","smoke","slate"],Z={RESET:"\x1B[0m",PREFIX:"\x1B[",SUFFIX:"m"},me={MINUTES_PAD:2,SECONDS_PAD:2,MILLISECONDS_PAD:3,SEPARATOR:":"},x={SCOPE_OPEN:"[",SCOPE_CLOSE:"]",TIME_OPEN:"|",TIME_CLOSE:"|",SEPARATOR:"-------------------------------",INDENT_BASE:3,PIPE:"| "},de={DEFAULT_WIDTH:80,MIN_WIDTH:40,MAX_LINE_LENGTH_RATIO:.8,BROWSER_DEFAULT_WIDTH:120},Ee={LOG_LEVEL:"A_LOGGER_LEVEL",DEFAULT_SCOPE_LENGTH:"A_LOGGER_DEFAULT_SCOPE_LENGTH",DEFAULT_SCOPE_COLOR:"A_LOGGER_DEFAULT_SCOPE_COLOR",DEFAULT_LOG_COLOR:"A_LOGGER_DEFAULT_LOG_COLOR"};var C=class extends A_Component{constructor(e,r){super();this.scope=e;this.config=r;this.COLORS=ut,this.STANDARD_SCOPE_LENGTH=r?.get(Ee.DEFAULT_SCOPE_LENGTH)||20;let o=r?.get(Ee.DEFAULT_SCOPE_COLOR),n=r?.get(Ee.DEFAULT_LOG_COLOR);if(o||n)this.DEFAULT_SCOPE_COLOR=o||this.generateColorFromScopeName(this.scope.name),this.DEFAULT_LOG_COLOR=n||this.generateColorFromScopeName(this.scope.name);else {let s=this.generateComplementaryColorsFromScope(this.scope.name);this.DEFAULT_SCOPE_COLOR=s.scopeColor,this.DEFAULT_LOG_COLOR=s.logColor;}this.TERMINAL_WIDTH=this.detectTerminalWidth(),this.MAX_CONTENT_WIDTH=Math.floor(this.TERMINAL_WIDTH*de.MAX_LINE_LENGTH_RATIO);}simpleHash(e){let r=0;for(let o=0;o<e.length;o++){let n=e.charCodeAt(o);r=(r<<5)-r+n,r=r&r;}return Math.abs(r)}generateColorFromScopeName(e){let r=gt,n=this.simpleHash(e)%r.length;return r[n]}generateComplementaryColorsFromScope(e){let r=[{scopeColor:"indigo",logColor:"lightBlue"},{scopeColor:"deepBlue",logColor:"cyan"},{scopeColor:"purple",logColor:"lavender"},{scopeColor:"steelBlue",logColor:"skyBlue"},{scopeColor:"slateBlue",logColor:"periwinkle"},{scopeColor:"charcoal",logColor:"silver"},{scopeColor:"violet",logColor:"brightMagenta"},{scopeColor:"darkGray",logColor:"lightGray"},{scopeColor:"cornflower",logColor:"powder"},{scopeColor:"slate",logColor:"smoke"}],n=this.simpleHash(e)%r.length;return r[n]}detectTerminalWidth(){try{if(A_Context.environment==="browser")return de.BROWSER_DEFAULT_WIDTH;if(typeof process<"u"&&process.stdout&&process.stdout.columns){let e=process.stdout.columns;return Math.max(e,de.MIN_WIDTH)}return de.DEFAULT_WIDTH}catch{return de.DEFAULT_WIDTH}}wrapText(e,r,o=true){if(A_Context.environment==="browser")return [e];let n=this.formattedScope.length+4+this.getTime().length+4,s=`${r}${x.PIPE}`,c=Math.max(this.TERMINAL_WIDTH-n-1,20),p=Math.max(this.TERMINAL_WIDTH-s.length,20);if(o&&e.length<=c)return [e];let m=[],_=e.split(" "),g="",u=o?c:p;for(let z of _){let $e=g?1:0;if(g.length+$e+z.length>u)if(g)m.push(g),g=z,u=p;else {if(z.length>u){let Fe=this.splitLongWord(z,u);m.push(...Fe.slice(0,-1)),g=Fe[Fe.length-1];}else g=z;u=p;}else g+=(g?" ":"")+z;}return g&&m.push(g),m.length?m:[e]}splitLongWord(e,r){let o=[];for(let n=0;n<e.length;n+=r)o.push(e.slice(n,n+r));return o}get scopeLength(){return Math.max(this.scope.name.length,this.STANDARD_SCOPE_LENGTH)}get formattedScope(){let e=this.scope.name,r=this.STANDARD_SCOPE_LENGTH;if(e.length>=r)return e.substring(0,r);let o=r-e.length,n=Math.floor(o/2),s=o-n;return " ".repeat(n)+e+" ".repeat(s)}compile(e,...r){let o=this.getTime(),n=" ".repeat(this.STANDARD_SCOPE_LENGTH+3),s=r.length>1;return [`${Z.PREFIX}${this.COLORS[this.DEFAULT_SCOPE_COLOR]}${Z.SUFFIX}${x.SCOPE_OPEN}${this.formattedScope}${x.SCOPE_CLOSE}${Z.RESET} ${Z.PREFIX}${this.COLORS[e]}${Z.SUFFIX}${x.TIME_OPEN}${o}${x.TIME_CLOSE}`,s?`
${n}${x.TIME_OPEN}${x.SEPARATOR}`:"",...r.map((c,p)=>{let m=p>0||s;switch(true){case c instanceof A_Error:return this.compile_A_Error(c);case c instanceof Error:return this.compile_Error(c);case(typeof c=="object"&&c!==null):return this.formatObject(c,m,n);default:return this.formatString(String(c),m,n)}}),s?`
${n}${x.TIME_OPEN}${x.SEPARATOR}${Z.RESET}`:Z.RESET]}formatObject(e,r,o){if(A_Context.environment==="browser")return e;if(e===null)return r?`
${o}${x.PIPE}null`:"null";if(e===void 0)return r?`
${o}${x.PIPE}undefined`:"undefined";let n;try{n=JSON.stringify(e,null,2);}catch{try{let g=new WeakSet;n=JSON.stringify(e,(u,U)=>{if(typeof U=="object"&&U!==null){if(g.has(U))return "[Circular Reference]";g.add(U);}return U},2);}catch{n=String(e);}}let s=`${o}${x.PIPE}`,c=this.TERMINAL_WIDTH-s.length-4,m=n.split(`
`).map(_=>{let g=_.match(/^(\s*"[^"]+":\s*")([^"]+)(".*)?$/);if(g&&g[2].length>c-g[1].length-(g[3]||"").length){let[,u,U,z=""]=g;if(U.length>c-u.length-z.length){let $e=this.wrapJsonStringValue(U,c-u.length-z.length);return u+$e+z}}return _}).join(`
`+s);return r?`
`+s+m:m}wrapJsonStringValue(e,r){return e.length<=r?e:r>6?e.substring(0,r-3)+"...":e.substring(0,Math.max(1,r))}formatString(e,r,o){if(A_Context.environment==="browser")return ((r?`
`:"")+e).replace(/\n/g,`
${o}${x.PIPE}`);let n=this.wrapText(e,o,!r),s=`${o}${x.PIPE}`,c=n.map((p,m)=>m===0&&!r?p:`${s}${p}`);return r?`
`+c.join(`
`):c.join(`
`)}shouldLog(e){switch(this.config?.get(Ee.LOG_LEVEL)||"info"){case "debug":return  true;case "info":return e==="info"||e==="warning"||e==="error";case "warn":return e==="warning"||e==="error";case "error":return e==="error";case "all":return  true;default:return  false}}debug(e,...r){this.shouldLog("debug")&&(typeof e=="string"&&this.COLORS[e]?console.log(...this.compile(e,...r)):console.log(...this.compile(this.DEFAULT_LOG_COLOR,e,...r)));}info(e,...r){this.shouldLog("info")&&(typeof e=="string"&&this.COLORS[e]?console.log(...this.compile(e,...r)):console.log(...this.compile(this.DEFAULT_LOG_COLOR,e,...r)));}log(e,...r){this.info(e,...r);}warning(...e){this.shouldLog("warning")&&console.log(...this.compile("yellow",...e));}error(...e){this.shouldLog("error")&&console.log(...this.compile("red",...e));}log_A_Error(e){let r=this.getTime(),o=" ".repeat(this.STANDARD_SCOPE_LENGTH+3);console.log(`\x1B[31m[${this.formattedScope}] |${r}| ERROR ${e.code}
${o}| ${e.message}
${o}| ${e.description} 
${o}|-------------------------------
${o}| ${e.stack?.split(`
`).map((n,s)=>s===0?n:`${o}| ${n}`).join(`
`)||"No stack trace"}
${o}|-------------------------------
\x1B[0m`+(e.originalError?`\x1B[31m${o}| Wrapped From  ${e.originalError.message}
${o}|-------------------------------
${o}| ${e.originalError.stack?.split(`
`).map((n,s)=>s===0?n:`${o}| ${n}`).join(`
`)||"No stack trace"}
${o}|-------------------------------
\x1B[0m`:"")+(e.link?`\x1B[31m${o}| Read in docs: ${e.link}
${o}|-------------------------------
\x1B[0m`:""));}compile_A_Error(e){let r=`${" ".repeat(this.STANDARD_SCOPE_LENGTH+3)}${x.PIPE}`,o=`${r}-------------------------------`,n=[];n.push(""),n.push(o),n.push(`${r}A_ERROR: ${e.code}`),n.push(o);let s=this.wrapText(`Message: ${e.message}`,r,false),c=this.wrapText(`Description: ${e.description}`,r,false);if(n.push(...s.map(p=>`${r}${p}`)),n.push(...c.map(p=>`${r}${p}`)),e.originalError){n.push(o),n.push(`${r}ORIGINAL ERROR:`),n.push(o);let p=this.wrapText(`${e.originalError.name}: ${e.originalError.message}`,r,false);if(n.push(...p.map(m=>`${r}${m}`)),e.originalError.stack){n.push(`${r}Stack trace:`);let m=this.formatStackTrace(e.originalError.stack,r);n.push(...m);}}if(e.stack){n.push(o),n.push(`${r}A_ERROR STACK:`),n.push(o);let p=this.formatStackTrace(e.stack,r);n.push(...p);}if(e.link){n.push(o);let p=this.wrapText(`Documentation: ${e.link}`,r,false);n.push(...p.map(m=>`${r}${m}`));}return n.push(o),n.join(`
`)}formatStackTrace(e,r){let o=e.split(`
`),n=[];return o.forEach((s,c)=>{if(s.trim()){let p=c===0?r:`${r}  `,m=this.wrapText(s.trim(),p,false);n.push(...m.map(_=>c===0&&_===m[0]?`${r}${_}`:`${r}  ${_}`));}}),n}compile_Error(e){let r=`${" ".repeat(this.STANDARD_SCOPE_LENGTH+3)}${x.PIPE}`,o=`${r}-------------------------------`,n=[];n.push(""),n.push(o),n.push(`${r}ERROR: ${e.name}`),n.push(o);let s=this.wrapText(`Message: ${e.message}`,r,false);if(n.push(...s.map(c=>`${r}${c}`)),e.stack){n.push(o),n.push(`${r}STACK TRACE:`),n.push(o);let c=this.formatStackTrace(e.stack,r);n.push(...c);}return n.push(o),n.join(`
`)}getTime(){let e=new Date,r=String(e.getMinutes()).padStart(me.MINUTES_PAD,"0"),o=String(e.getSeconds()).padStart(me.SECONDS_PAD,"0"),n=String(e.getMilliseconds()).padStart(me.MILLISECONDS_PAD,"0");return `${r}${me.SEPARATOR}${o}${me.SEPARATOR}${n}`}};i(C,"A_Logger"),C=a([A_Frame.Component({namespace:"A-Utils",name:"A_Logger",description:"Advanced Logging Component with Scope-based Output Formatting that provides color-coded console output, multi-type support, and configurable log levels for enhanced debugging and monitoring."}),l(0,A_Inject(A_Scope)),l(1,A_Inject(h))],C);var lr,pr,_r,mr,dr,ur,gr,hr,fr,yr,Er,A=class extends A_Entity{constructor(e){super(e);this._listeners=new Map;}static get code(){return super.entity}get duration(){return this._endTime&&this._startTime?this._endTime.getTime()-this._startTime.getTime():this._startTime?new Date().getTime()-this._startTime.getTime():void 0}get idleTime(){return this._startTime&&this._createdAt?this._startTime.getTime()-this._createdAt.getTime():void 0}get scope(){return this._executionScope}get context(){return this.scope.resolve(R)}get code(){return this.constructor.code}get status(){return this._status}get createdAt(){return this._createdAt}get startedAt(){return this._startTime}get endedAt(){return this._endTime}get result(){return this._result}get error(){return this._error}get params(){return this._params}get isProcessed(){return this._status==="COMPLETED"||this._status==="FAILED"}async[Er="_A_StateMachine_onBeforeTransition"](e,r,...o){this.checkScopeInheritance(),r?.debug("yellow",`Command ${this.aseid.toString()} transitioning from ${e.from} to ${e.to}`);}async[yr="created_initialized"](e,...r){this._status==="CREATED"&&(this._createdAt=new Date,this._status="INITIALIZED",this.emit("onInit"));}async[fr="initialized_executing"](e,...r){this._status!=="INITIALIZED"&&this._status!=="CREATED"||(this._startTime=new Date,this._status="EXECUTING",this.emit("onExecute"));}async[hr="executing_completed"](e,...r){this._endTime=new Date,this._status="COMPLETED",this.emit("onComplete");}async[gr="executing_failed"](e,r,...o){this._endTime=new Date,this._status="FAILED",this.emit("onFail");}async[ur="_A_Command_onInit"](e,...r){await e.transition("CREATED","INITIALIZED");}async[dr="_A_Command_onBeforeExecute"](e,...r){await e.transition("INITIALIZED","EXECUTING");}async[mr="_A_Command_onExecute"](...e){}async[_r="_A_Command_onAfterExecute"](...e){}async[pr="_A_Command_onComplete"](e,...r){await e.transition("EXECUTING","COMPLETED");}async[lr="_A_Command_onFail"](e,r,...o){await e.transition("EXECUTING","FAILED");}async init(){await this.call("_A_Command_onInit",this.scope);}async execute(){if(!this.isProcessed)try{this.checkScopeInheritance();let e=new R("execute-command");this.scope.register(e),await new Promise(async(r,o)=>{try{let n=new A_Feature({name:"_A_Command_onBeforeExecute",component:this,scope:this.scope}),s=new A_Feature({name:"_A_Command_onExecute",component:this,scope:this.scope}),c=new A_Feature({name:"_A_Command_onAfterExecute",component:this,scope:this.scope});this.on("onComplete",()=>{n.interrupt(),s.interrupt(),c.interrupt(),r();}),this.on("onFail",()=>{n.interrupt(),s.interrupt(),c.interrupt(),o(this.error);}),await n.process(this.scope),await s.process(this.scope),await c.process(this.scope),this._origin==="invoked"&&await this.complete(),r();}catch(n){o(n);}});}catch(e){let r=e instanceof A_Error?e:new q({title:q.ExecutionError,description:`An error occurred while executing command "${this.aseid.toString()}".`,originalError:e});await this.fail(r);}}async complete(e){this.isProcessed||(this._status="COMPLETED",this._result=e,await this.call("_A_Command_onComplete",this.scope),this.scope.destroy());}async fail(e){this.isProcessed||(this._status="FAILED",e&&(this._error=e,this.scope.register(e)),await this.call("_A_Command_onFail",this.scope),this.scope.destroy());}on(e,r){this._listeners.has(e)||this._listeners.set(e,new Set),this._listeners.get(e).add(r);}off(e,r){this._listeners.get(e)?.delete(r);}emit(e){this._listeners.get(e)?.forEach(async r=>{r(this);});}fromNew(e){super.fromNew(e),this._origin="invoked",this._executionScope=new A_Scope({name:`A-Command-Execution-Scope-${this.aseid.toString()}`,components:[E]}),this._createdAt=new Date,this._params=e,this._status="CREATED";}fromJSON(e){super.fromJSON(e),this._origin="serialized",this._executionScope=new A_Scope({name:`A-Command-Execution-Scope-${this.aseid.toString()}`,components:[E]}),e.createdAt&&(this._createdAt=new Date(e.createdAt)),e.startedAt&&(this._startTime=new Date(e.startedAt)),e.endedAt&&(this._endTime=new Date(e.endedAt)),this._params=e.params,this._status=e.status,e.error&&(this._error=new q(e.error)),e.result&&(this._result=e.result);}toJSON(){return {...super.toJSON(),code:this.code,status:this._status,params:this._params,createdAt:this._createdAt.toISOString(),startedAt:this._startTime?this._startTime.toISOString():void 0,endedAt:this._endTime?this._endTime.toISOString():void 0,duration:this.duration,idleTime:this.idleTime,result:this.result,error:this.error?this.error.toJSON():void 0}}checkScopeInheritance(){let e;try{e=A_Context.scope(this);}catch(r){throw new q({title:q.CommandScopeBindingError,description:`Command ${this.aseid.toString()} is not bound to any context scope. Ensure the command is properly registered within a context before execution.`,originalError:r})}this.scope.isInheritedFrom(A_Context.scope(this))||this.scope.inherit(A_Context.scope(this));}};i(A,"A_Command"),a([A_Feature.Extend(),l(0,A_Inject(P)),l(1,A_Inject(C))],A.prototype,Er,1),a([A_Feature.Extend(),l(0,A_Inject(P))],A.prototype,yr,1),a([A_Feature.Extend(),l(0,A_Inject(P))],A.prototype,fr,1),a([A_Feature.Extend(),l(0,A_Inject(P))],A.prototype,hr,1),a([A_Feature.Extend(),l(0,A_Inject(P)),l(1,A_Inject(A_Error))],A.prototype,gr,1),a([A_Feature.Extend(),l(0,A_Inject(E))],A.prototype,ur,1),a([A_Feature.Extend({after:/.*/}),l(0,A_Dependency.Required()),l(0,A_Inject(E))],A.prototype,dr,1),a([A_Feature.Extend()],A.prototype,mr,1),a([A_Feature.Extend()],A.prototype,_r,1),a([A_Feature.Extend({after:/.*/}),l(0,A_Inject(E))],A.prototype,pr,1),a([A_Feature.Extend({after:/.*/}),l(0,A_Dependency.Required()),l(0,A_Inject(E)),l(1,A_Inject(R))],A.prototype,lr,1),A=a([A_Frame.Entity({namespace:"A-Utils",name:"A-Command",description:"Advanced Command Pattern Implementation with full lifecycle management, event handling, and state persistence. This entity allows to execute commands in distributed environment across multiple services."})],A);var qe=class qe{constructor(t){this.logger=t;this._initialized=false;}get isInitialized(){return this._initialized}async get(){return this._initialized||await this.init(),this._fs}async init(){try{A_Context.environment==="server"?await this.initServer():this.initBrowser(),this._initialized=!0;}catch{this.initBrowser(),this._initialized=true;}}async initServer(){this._fs=await import('fs');}initBrowser(){this._fs={readFileSync:i((t,e)=>(this.logger.warning("fs.readFileSync not available in browser environment"),""),"readFileSync"),existsSync:i(t=>(this.logger.warning("fs.existsSync not available in browser environment"),false),"existsSync"),createReadStream:i(t=>(this.logger.warning("fs.createReadStream not available in browser environment"),null),"createReadStream")};}};i(qe,"A_FSPolyfillClass");var Re=qe;var je=class je{constructor(t){this.logger=t;this._initialized=false;}get isInitialized(){return this._initialized}async get(t){return this._initialized||(this._fsPolyfill=t,await this.init()),this._crypto}async init(){try{A_Context.environment==="server"?await this.initServer():this.initBrowser(),this._initialized=!0;}catch{this.initBrowser(),this._initialized=true;}}async initServer(){let t=await import('crypto');this._crypto={createTextHash:i((e,r="sha384")=>Promise.resolve(`${r}-${t.createHash(r).update(e).digest("base64")}`),"createTextHash"),createFileHash:i((e,r="sha384")=>new Promise(async(o,n)=>{try{if(!this._fsPolyfill)throw new Error("FS polyfill is required for file hashing");let s=t.createHash(r),c=this._fsPolyfill.createReadStream(e);c.on("data",p=>s.update(p)),c.on("end",()=>o(`${r}-${s.digest("base64")}`)),c.on("error",p=>n(p));}catch(s){n(s);}}),"createFileHash")};}initBrowser(){this._crypto={createFileHash:i(()=>(this.logger.warning("File hash not available in browser environment"),Promise.resolve("")),"createFileHash"),createTextHash:i((t,e="SHA-384")=>new Promise(async(r,o)=>{try{if(!crypto.subtle)throw new Error("SubtleCrypto not available");let s=new TextEncoder().encode(t),c=await crypto.subtle.digest(e,s),p=Array.from(new Uint8Array(c)),m=btoa(String.fromCharCode(...p));r(`${e}-${m}`);}catch(n){o(n);}}),"createTextHash")};}};i(je,"A_CryptoPolyfillClass");var Pe=je;var Ke=class Ke{constructor(t){this.logger=t;this._initialized=false;}get isInitialized(){return this._initialized}async get(){return this._initialized||await this.init(),this._http}async init(){try{A_Context.environment==="server"?await this.initServer():this.initBrowser(),this._initialized=!0;}catch{this.initBrowser(),this._initialized=true;}}async initServer(){let t=await import('http');this._http={request:t.request,get:t.get,createServer:t.createServer};}initBrowser(){this._http={request:i((t,e)=>(this.logger.warning("http.request not available in browser/test environment, use fetch instead"),this.createMockRequest(t,e,false)),"request"),get:i((t,e)=>(this.logger.warning("http.get not available in browser/test environment, use fetch instead"),this.createMockRequest(typeof t=="string"?{hostname:t}:t,e,false)),"get"),createServer:i(()=>(this.logger.error("http.createServer not available in browser/test environment"),null),"createServer")};}createMockRequest(t,e,r=false){return {end:i(()=>{if(e){let n={statusCode:200,headers:{},on:i((s,c)=>{s==="data"?setTimeout(()=>c("mock data"),0):s==="end"&&setTimeout(()=>c(),0);},"on"),pipe:i(s=>{s.write&&s.write("mock data"),s.end&&s.end();},"pipe")};setTimeout(()=>e(n),0);}},"end"),write:i(n=>{},"write"),on:i((n,s)=>{},"on")}}};i(Ke,"A_HttpPolyfillClass");var Le=Ke;var We=class We{constructor(t){this.logger=t;this._initialized=false;}get isInitialized(){return this._initialized}async get(){return this._initialized||await this.init(),this._https}async init(){try{A_Context.environment==="server"?await this.initServer():this.initBrowser(),this._initialized=!0;}catch{this.initBrowser(),this._initialized=true;}}async initServer(){let t=await import('https');this._https={request:t.request,get:t.get,createServer:t.createServer};}initBrowser(){this._https={request:i((t,e)=>(this.logger.warning("https.request not available in browser/test environment, use fetch instead"),this.createMockRequest(t,e,true)),"request"),get:i((t,e)=>(this.logger.warning("https.get not available in browser/test environment, use fetch instead"),this.createMockRequest(typeof t=="string"?{hostname:t}:t,e,true)),"get"),createServer:i(()=>(this.logger.error("https.createServer not available in browser/test environment"),null),"createServer")};}createMockRequest(t,e,r=true){return {end:i(()=>{if(e){let n={statusCode:200,headers:{},on:i((s,c)=>{s==="data"?setTimeout(()=>c("mock data"),0):s==="end"&&setTimeout(()=>c(),0);},"on"),pipe:i(s=>{s.write&&s.write("mock data"),s.end&&s.end();},"pipe")};setTimeout(()=>e(n),0);}},"end"),write:i(n=>{},"write"),on:i((n,s)=>{},"on")}}};i(We,"A_HttpsPolyfillClass");var Ie=We;var Je=class Je{constructor(t){this.logger=t;this._initialized=false;}get isInitialized(){return this._initialized}async get(){return this._initialized||await this.init(),this._path}async init(){try{A_Context.environment==="server"?await this.initServer():this.initBrowser(),this._initialized=!0;}catch{this.initBrowser(),this._initialized=true;}}async initServer(){this._path=await import('path');}initBrowser(){this._path={join:i((...t)=>t.join("/").replace(/\/+/g,"/"),"join"),resolve:i((...t)=>{let e="";for(let r of t)r.startsWith("/")?e=r:e=this._path.join(e,r);return e||"/"},"resolve"),dirname:i(t=>t.split("/").slice(0,-1).join("/")||"/","dirname"),basename:i((t,e)=>{let r=t.split("/").pop()||"";return e&&r.endsWith(e)?r.slice(0,-e.length):r},"basename"),extname:i(t=>{let e=t.split(".");return e.length>1?"."+e.pop():""},"extname"),relative:i((t,e)=>e.replace(t,"").replace(/^\//,""),"relative"),normalize:i(t=>t.replace(/\/+/g,"/").replace(/\/$/,"")||"/","normalize"),isAbsolute:i(t=>t.startsWith("/")||/^[a-zA-Z]:/.test(t),"isAbsolute"),parse:i(t=>{let e=this._path.extname(t),r=this._path.basename(t),o=this._path.basename(t,e);return {root:"/",dir:this._path.dirname(t),base:r,ext:e,name:o}},"parse"),format:i(t=>this._path.join(t.dir||"",t.base||""),"format"),sep:"/",delimiter:":"};}};i(Je,"A_PathPolyfillClass");var Oe=Je;var Xe=class Xe{constructor(t){this.logger=t;this._initialized=false;}get isInitialized(){return this._initialized}async get(){return this._initialized||await this.init(),this._url}async init(){try{A_Context.environment==="server"?await this.initServer():this.initBrowser(),this._initialized=!0;}catch{this.initBrowser(),this._initialized=true;}}async initServer(){let t=await import('url');this._url={parse:t.parse,format:t.format,resolve:t.resolve,URL:t.URL||globalThis.URL,URLSearchParams:t.URLSearchParams||globalThis.URLSearchParams};}initBrowser(){this._url={parse:i(t=>{try{let e=new URL(t);return {protocol:e.protocol,hostname:e.hostname,port:e.port,pathname:e.pathname,search:e.search,hash:e.hash,host:e.host,href:e.href}}catch{return {}}},"parse"),format:i(t=>{try{return new URL("",t.href||`${t.protocol}//${t.host}${t.pathname}${t.search}${t.hash}`).href}catch{return ""}},"format"),resolve:i((t,e)=>{try{return new URL(e,t).href}catch{return e}},"resolve"),URL:globalThis.URL,URLSearchParams:globalThis.URLSearchParams};}};i(Xe,"A_UrlPolyfillClass");var be=Xe;var Ze=class Ze{constructor(t){this.logger=t;this._initialized=false;}get isInitialized(){return this._initialized}async get(){return this._initialized||await this.init(),this._buffer}async init(){try{A_Context.environment==="server"?await this.initServer():this.initBrowser(),this._initialized=!0;}catch{this.initBrowser(),this._initialized=true;}}async initServer(){let t=await import('buffer');this._buffer={from:t.Buffer.from,alloc:t.Buffer.alloc,allocUnsafe:t.Buffer.allocUnsafe,isBuffer:t.Buffer.isBuffer,concat:t.Buffer.concat};}initBrowser(){this._buffer={from:i((t,e)=>typeof t=="string"?new TextEncoder().encode(t):new Uint8Array(t),"from"),alloc:i((t,e)=>{let r=new Uint8Array(t);return e!==void 0&&r.fill(e),r},"alloc"),allocUnsafe:i(t=>new Uint8Array(t),"allocUnsafe"),isBuffer:i(t=>t instanceof Uint8Array||t instanceof ArrayBuffer,"isBuffer"),concat:i((t,e)=>{let r=e||t.reduce((s,c)=>s+c.length,0),o=new Uint8Array(r),n=0;for(let s of t)o.set(s,n),n+=s.length;return o},"concat")};}};i(Ze,"A_BufferPolyfillClass");var Ne=Ze;var Qe=class Qe{constructor(t){this.logger=t;this._initialized=false;}get isInitialized(){return this._initialized}async get(){return this._initialized||await this.init(),this._process}async init(){try{A_Context.environment==="server"?this.initServer():this.initBrowser(),this._initialized=!0;}catch{this.initBrowser(),this._initialized=true;}}initServer(){this._process={env:process.env,argv:process.argv,platform:process.platform,version:process.version,versions:process.versions,cwd:process.cwd,exit:process.exit,nextTick:process.nextTick};}initBrowser(){this._process={env:{NODE_ENV:"browser",...globalThis.process?.env||{}},argv:["browser"],platform:"browser",version:"browser",versions:{node:"browser"},cwd:i(()=>"/","cwd"),exit:i(t=>{throw this.logger.warning("process.exit not available in browser"),new Error(`Process exit with code ${t}`)},"exit"),nextTick:i((t,...e)=>{setTimeout(()=>t(...e),0);},"nextTick")};}};i(Qe,"A_ProcessPolyfillClass");var De=Qe;var T=class extends A_Component{constructor(e){super();this.logger=e;this._initializing=null;}get ready(){return this._initialized||(this._initialized=this._loadInternal()),this._initialized}async load(){await this.ready;}async attachToWindow(){A_Context.environment==="browser"&&(globalThis.A_Polyfill=this,globalThis.process={env:{NODE_ENV:"production"},cwd:i(()=>"/","cwd")},globalThis.__dirname="/");}async _loadInternal(){this._fsPolyfill=new Re(this.logger),this._cryptoPolyfill=new Pe(this.logger),this._httpPolyfill=new Le(this.logger),this._httpsPolyfill=new Ie(this.logger),this._pathPolyfill=new Oe(this.logger),this._urlPolyfill=new be(this.logger),this._bufferPolyfill=new Ne(this.logger),this._processPolyfill=new De(this.logger),await this._fsPolyfill.get(),await this._cryptoPolyfill.get(await this._fsPolyfill.get()),await this._httpPolyfill.get(),await this._httpsPolyfill.get(),await this._pathPolyfill.get(),await this._urlPolyfill.get(),await this._bufferPolyfill.get(),await this._processPolyfill.get();}async fs(){return await this.ready,await this._fsPolyfill.get()}async crypto(){return await this.ready,await this._cryptoPolyfill.get()}async http(){return await this.ready,await this._httpPolyfill.get()}async https(){return await this.ready,await this._httpsPolyfill.get()}async path(){return await this.ready,await this._pathPolyfill.get()}async url(){return await this.ready,await this._urlPolyfill.get()}async buffer(){return await this.ready,await this._bufferPolyfill.get()}async process(){return await this.ready,await this._processPolyfill.get()}};i(T,"A_Polyfill"),a([A_Concept.Load()],T.prototype,"load",1),a([A_Concept.Load()],T.prototype,"attachToWindow",1),T=a([A_Frame.Component({namespace:"A-Utils",name:"A-Polyfill",description:"Polyfill component that provides cross-environment compatibility for Node.js core modules such as fs, crypto, http, https, path, url, buffer, and process. It dynamically loads appropriate polyfills based on the execution environment (Node.js or browser), enabling seamless usage of these modules in different contexts."}),l(0,A_Inject(C))],T);var b=class extends A_Component{constructor(e){super();this.polyfill=e;this.DEFAULT_ALLOWED_TO_READ_PROPERTIES=[...A_CONSTANTS__DEFAULT_ENV_VARIABLES_ARRAY,..._e];}async attachContext(e,r,o){o||(o=new h({defaults:{}}),e.scope.register(o));let n=await this.getProjectRoot();o.set("A_CONCEPT_ROOT_FOLDER",n);}async initialize(e){let r=await this.read();for(let o in r)e.set(o,r[o]);}resolve(e){return e}async read(e=[]){return {}}async getProjectRoot(e=__dirname){return (await this.polyfill.process()).cwd()}};i(b,"ConfigReader"),a([A_Concept.Load(),l(0,A_Inject(A_Container)),l(1,A_Inject(A_Scope)),l(2,A_Inject(h))],b.prototype,"attachContext",1),a([A_Concept.Load(),l(0,A_Dependency.Required()),l(0,A_Inject(h))],b.prototype,"initialize",1),b=a([A_Frame.Component({namespace:"A-Utils",name:"ConfigReader",description:"Abstract component for reading configuration data from various sources such as files, environment variables, or remote services. This component can be extended to implement specific configuration reading strategies."}),l(0,A_Dependency.Required()),l(0,A_Inject(T))],b);var j=class extends b{constructor(){super(...arguments);this.FileData=new Map;}getConfigurationProperty_File_Alias(e){return A_FormatterHelper.toCamelCase(e)}resolve(e){return this.FileData.get(this.getConfigurationProperty_File_Alias(e))}async read(e){let r=await this.polyfill.fs();try{let o=r.readFileSync(`${A_Context.concept}.conf.json`,"utf8"),n=JSON.parse(o);return this.FileData=new Map(Object.entries(n)),n}catch{return {}}}};i(j,"FileConfigReader"),j=a([A_Frame.Component({namespace:"A-Utils",name:"FileConfigReader",description:"Configuration reader that loads configuration data from a JSON file located in the application root directory. It reads the file named after the current concept with a .conf.json extension and parses its contents into the configuration context."})],j);var G=class extends b{async readEnvFile(t,e,r){let o=await e.fs();o.existsSync(".env")&&o.readFileSync(`${t.get("A_CONCEPT_ROOT_FOLDER")}/.env`,"utf-8").split(`
`).forEach(n=>{let[s,c]=n.split("=");s&&c&&(process.env[s.trim()]=c.trim());});}getConfigurationProperty_ENV_Alias(t){return A_FormatterHelper.toUpperSnakeCase(t)}resolve(t){return process.env[this.getConfigurationProperty_ENV_Alias(t)]}async read(t=[]){let e=[...t,...Object.keys(process.env)],r={};return e.forEach(o=>{r[o]=this.resolve(o);}),r}};i(G,"ENVConfigReader"),a([A_Concept.Load({before:["ENVConfigReader.initialize"]}),l(0,A_Inject(h)),l(1,A_Inject(T)),l(2,A_Inject(A_Feature))],G.prototype,"readEnvFile",1),G=a([A_Frame.Component({namespace:"A-Utils",name:"ENVConfigReader",description:"Configuration reader that sources configuration data from environment variables. It supports loading variables from a .env file and maps them to the configuration context, making it suitable for applications running in diverse environments such as local development, staging, and production."})],G);var Q=class extends A_Container{async prepare(t){if(!this.scope.has(h)){let r=new h({variables:[...A_CONSTANTS__DEFAULT_ENV_VARIABLES_ARRAY,..._e],defaults:{}});this.scope.register(r);}let e=await t.fs();try{switch(!0){case(A_Context.environment==="server"&&!!e.existsSync(`${A_Context.concept}.conf.json`)):this.reader=this.scope.resolve(j);break;case(A_Context.environment==="server"&&!e.existsSync(`${A_Context.concept}.conf.json`)):this.reader=this.scope.resolve(G);break;case A_Context.environment==="browser":this.reader=this.scope.resolve(G);break;default:throw new B(B.InitializationError,`Environment ${A_Context.environment} is not supported`)}}catch(r){if(r instanceof A_ScopeError)throw new B({title:B.InitializationError,description:`Failed to initialize A_ConfigLoader. Reader not found for environment ${A_Context.environment}`,originalError:r})}}};i(Q,"A_ConfigLoader"),a([A_Concept.Load({before:/.*/}),l(0,A_Inject(T))],Q.prototype,"prepare",1),Q=a([A_Frame.Container({namespace:"A-Utils",name:"A-ConfigLoader",description:"Container responsible for loading and initializing the A_Config component based on the environment and available configuration sources. It can be useful for application that need a separated configuration management and sharable across multiple containers."})],Q);var Jr=(re=>re)(Jr||{});var ke={A_LOGGER_LEVEL:"A_LOGGER_LEVEL",A_LOGGER_DEFAULT_SCOPE_LENGTH:"A_LOGGER_DEFAULT_SCOPE_LENGTH",A_LOGGER_DEFAULT_SCOPE_COLOR:"A_LOGGER_DEFAULT_SCOPE_COLOR",A_LOGGER_DEFAULT_LOG_COLOR:"A_LOGGER_DEFAULT_LOG_COLOR"},Us=[ke.A_LOGGER_LEVEL,ke.A_LOGGER_DEFAULT_SCOPE_LENGTH,ke.A_LOGGER_DEFAULT_SCOPE_COLOR,ke.A_LOGGER_DEFAULT_LOG_COLOR];var Me=class Me extends A_Error{};i(Me,"A_ManifestError"),Me.ManifestInitializationError="A-Manifest Initialization Error";var ee=Me;var tt=class tt{constructor(t,e,r,o=false){this.manifest=t;this.component=e;this.method=r;this.checkExclusion=o;}for(t){let e=this.manifest.internal_checkAccess({component:this.component,method:this.method,target:t});return this.checkExclusion?!e:e}};i(tt,"A_ManifestChecker");var ue=tt;var ae=class extends A_Fragment{constructor(e=[]){super({name:"A-Manifest"});this.rules=[];this.prepare(e);}prepare(e){if(!A_TypeGuards.isArray(e))throw new ee(ee.ManifestInitializationError,"A-Manifest configuration should be an array of configurations");for(let r of e)this.processConfigItem(r);}processConfigItem(e){if(!A_TypeGuards.isComponentConstructor(e.component))throw new ee(ee.ManifestInitializationError,"A-Manifest configuration item should be a A-Component constructor");let r=this.constructorToRegex(e.component);if(e.apply||e.exclude){let o=/.*/;this.rules.push({componentRegex:r,methodRegex:o,applyRegex:e.apply?this.allowedComponentsToRegex(e.apply):void 0,excludeRegex:e.exclude?this.allowedComponentsToRegex(e.exclude):void 0});}if(e.methods&&e.methods.length>0)for(let o of e.methods){let n=this.methodToRegex(o.method);this.rules.push({componentRegex:r,methodRegex:n,applyRegex:o.apply?this.allowedComponentsToRegex(o.apply):void 0,excludeRegex:o.exclude?this.allowedComponentsToRegex(o.exclude):void 0});}}constructorToRegex(e){return new RegExp(`^${this.escapeRegex(e.name)}$`)}methodToRegex(e){return e instanceof RegExp?e:new RegExp(`^${this.escapeRegex(e)}$`)}allowedComponentsToRegex(e){if(e instanceof RegExp)return e;let r=e.map(o=>this.escapeRegex(o.name));return new RegExp(`^(${r.join("|")})$`)}escapeRegex(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}configItemToRegexp(e){return this.constructorToRegex(e)}ID(e,r){return `${e.name}.${r}`}isAllowed(e,r){let o=typeof e=="function"?e:e.constructor;return new ue(this,o,r)}internal_checkAccess(e){let r=e.component.name,o=e.method,n=e.target.name,s=this.rules.filter(c=>c.componentRegex.test(r)&&c.methodRegex.test(o)).sort((c,p)=>{let m=c.methodRegex.source===".*",_=p.methodRegex.source===".*";return m&&!_?1:!m&&_?-1:0});if(s.length===0)return  true;for(let c of s){if(c.excludeRegex&&c.excludeRegex.test(n))return  false;if(c.applyRegex)return c.applyRegex.test(n)}return  true}isExcluded(e,r){let o=typeof e=="function"?e:e.constructor;return new ue(this,o,r,true)}};i(ae,"A_Manifest"),ae=a([A_Frame.Fragment({namespace:"A-Utils",name:"A-Manifest",description:"A-Manifest is a configuration fragment that allows to include or exclude component application for particular methods. It provides fine-grained control over which components are applied to which targets and methods within the application, enabling flexible and dynamic behavior based on defined rules."})],ae);var eo=(_=>(_.onInit="_A_Memory_onInit",_.onDestroy="_A_Memory_onDestroy",_.onExpire="_A_Memory_onExpire",_.onError="_A_Memory_onError",_.onSerialize="_A_Memory_onSerialize",_.onSet="_A_Memory_onSet",_.onGet="_A_Memory_onGet",_.onDrop="_A_Memory_onDrop",_.onClear="_A_Memory_onClear",_.onHas="_A_Memory_onHas",_))(eo||{});var w=class extends A_Fragment{constructor(){super(...arguments);this._storage=new Map;}set(e,r){this._storage.set(e,r);}get(e){return this._storage.get(e)}delete(e){this._storage.delete(e);}has(e){return this._storage.has(e)}clear(){this._storage.clear();}};i(w,"A_MemoryContext"),w=a([A_Frame.Fragment({namespace:"A-Utils",name:"A-MemoryContext",description:"In-memory context fragment that provides a simple key-value store for temporary data storage during application runtime. It allows setting, getting, deleting, and checking the existence of key-value pairs, facilitating quick access to transient data without persistent storage. This context is useful for scenarios where data needs to be shared across different components or operations within the same execution context."})],w);var $=class $ extends A_Error{};i($,"A_MemoryError"),$.MemoryInitializationError="Memory initialization error",$.MemoryDestructionError="Memory destruction error",$.MemoryGetError="Memory GET operation failed",$.MemorySetError="Memory SET operation failed",$.MemoryDropError="Memory DROP operation failed",$.MemoryClearError="Memory CLEAR operation failed",$.MemoryHasError="Memory HAS operation failed",$.MemorySerializeError="Memory toJSON operation failed";var f=$;var so,ao,co,lo,po,_o,mo,uo,go,v=class extends A_Component{get ready(){return this._ready||(this._ready=this.init()),this._ready}async[go="_A_Memory_onError"](...t){}async[uo="_A_Memory_onExpire"](...t){}async[mo="_A_Memory_onInit"](t,...e){t||(t=new w,A_Context.scope(this).register(t));}async[_o="_A_Memory_onDestroy"](t,...e){t.clear();}async[po="_A_Memory_onGet"](t,e,...r){t.succeed(e.get(t.params.key));}async[lo="_A_Memory_onHas"](t,e,...r){t.succeed(e.has(t.params.key));}async[co="_A_Memory_onSet"](t,e,r,...o){e.set(t.params.key,t.params.value);}async[ao="_A_Memory_onDrop"](t,e,...r){e.delete(t.params.key);}async[so="_A_Memory_onClear"](t,e,...r){e.clear();}async init(){if(this._ready)return this._ready;let t=new A_Scope({name:"A-Memory-Init-Scope"}).inherit(A_Context.scope(this));try{await this.call("_A_Memory_onInit",t);}catch(e){let r=new f({title:f.MemoryInitializationError,description:"An error occurred during memory initialization",originalError:e});throw t.register(r),await this.call("_A_Memory_onError",t),t.destroy(),r}}async destroy(){let t=new A_Scope({name:"A-Memory-Destroy-Scope"}).inherit(A_Context.scope(this));try{this._ready=void 0,await this.call("_A_Memory_onDestroy",t);}catch(e){let r=new f({title:f.MemoryDestructionError,description:"An error occurred during memory destruction",originalError:e});throw t.register(r),await this.call("_A_Memory_onError",t),t.destroy(),r}}async get(t){let e=new d("get",{key:t}),r=new A_Scope({name:"A-Memory-Get-Operation-Scope",fragments:[e]}).inherit(A_Context.scope(this));try{return await this.call("_A_Memory_onGet",r),r.destroy(),e.result}catch(o){let n=new f({title:f.MemoryGetError,description:`An error occurred while getting the value for key "${String(t)}"`,originalError:o});throw r.register(n),await this.call("_A_Memory_onError",r),r.destroy(),n}}async has(t){let e=new d("has",{key:t}),r=new A_Scope({name:"A-Memory-Has-Operation-Scope",fragments:[e]}).inherit(A_Context.scope(this));try{return await this.call("_A_Memory_onHas",r),r.destroy(),e.result}catch(o){let n=new f({title:f.MemoryHasError,description:`An error occurred while checking existence for key "${String(t)}"`,originalError:o});throw r.register(n),await this.call("_A_Memory_onError",r),r.destroy(),n}}async set(t,e){let r=new d("set",{key:t,value:e}),o=new A_Scope({name:"A-Memory-Set-Operation-Scope",fragments:[r]}).inherit(A_Context.scope(this));try{await this.call("_A_Memory_onSet",o);}catch(n){let s=new f({title:f.MemorySetError,description:`An error occurred while setting the value for key "${String(t)}"`,originalError:n});throw o.register(s),await this.call("_A_Memory_onError",o),o.destroy(),s}}async drop(t){let e=new d("drop",{key:t}),r=new A_Scope({name:"A-Memory-Drop-Operation-Scope",fragments:[e]}).inherit(A_Context.scope(this));try{await this.call("_A_Memory_onDrop",r);}catch(o){let n=new f({title:f.MemoryDropError,description:`An error occurred while dropping the value for key "${String(t)}"`,originalError:o});throw r.register(n),await this.call("_A_Memory_onError",r),r.destroy(),n}}async clear(){let t=new d("clear"),e=new A_Scope({name:"A-Memory-Clear-Operation-Scope",fragments:[t]}).inherit(A_Context.scope(this));try{await this.call("_A_Memory_onClear",e);}catch(r){let o=new f({title:f.MemoryClearError,description:"An error occurred while clearing the memory",originalError:r});throw e.register(o),await this.call("_A_Memory_onError",e),e.destroy(),o}}async toJSON(){let t=new d("serialize"),e=new A_Scope({name:"A-Memory-Serialize-Operation-Scope",fragments:[t]}).inherit(A_Context.scope(this));try{return await this.call("_A_Memory_onSerialize",e),t.result}catch(r){let o=new f({title:f.MemorySerializeError,description:"An error occurred while serializing the memory",originalError:r});throw e.register(o),await this.call("_A_Memory_onError",e),e.destroy(),o}}};i(v,"A_Memory"),a([A_Feature.Extend()],v.prototype,go,1),a([A_Feature.Extend()],v.prototype,uo,1),a([A_Feature.Extend(),l(0,A_Inject(w))],v.prototype,mo,1),a([A_Feature.Extend(),l(0,A_Inject(w))],v.prototype,_o,1),a([A_Feature.Extend(),l(0,A_Dependency.Required()),l(0,A_Inject(d)),l(1,A_Inject(w))],v.prototype,po,1),a([A_Feature.Extend(),l(0,A_Dependency.Required()),l(0,A_Inject(d)),l(1,A_Inject(w))],v.prototype,lo,1),a([A_Feature.Extend(),l(0,A_Dependency.Required()),l(0,A_Inject(d)),l(1,A_Inject(w)),l(2,A_Inject(A_Scope))],v.prototype,co,1),a([A_Feature.Extend(),l(0,A_Dependency.Required()),l(0,A_Inject(d)),l(1,A_Inject(w))],v.prototype,ao,1),a([A_Feature.Extend(),l(0,A_Dependency.Required()),l(0,A_Inject(d)),l(1,A_Inject(w))],v.prototype,so,1),v=a([A_Frame.Component({namespace:"A-Utils",name:"A-Memory",description:"In-memory data storage component that provides a simple key-value store with asynchronous operations. It supports basic memory operations such as get, set, has, drop, and clear, along with lifecycle management and error handling features. This components features can be extended with other components to provide ability store data across multiple storage, or extract data from multiple external sources. Good example is to store some runtime data that needs to be shared across multiple containers or concepts."})],v);var ho=(_=>(_.onBeforeLoad="_A_Service_onBeforeLoad",_.onLoad="_A_Service_onLoad",_.onAfterLoad="_A_Service_onAfterLoad",_.onBeforeStart="_A_Service_onBeforeStart",_.onStart="_A_Service_onStart",_.onAfterStart="_A_Service_onAfterStart",_.onBeforeStop="_A_Service_onBeforeStop",_.onStop="_A_Service_onStop",_.onAfterStop="_A_Service_onAfterStop",_.onError="_A_Service_onError",_))(ho||{});var ge=class ge extends A_Error{};i(ge,"A_Service_Error"),ge.ServiceLoadError="Service load error",ge.ServiceStartError="Service start error",ge.ServiceStopError="Service stop error";var L=ge;var To,Ao,So,xo,Co,wo,vo,Ro,Po,Lo,y=class extends A_Container{async load(){try{await this.call("_A_Service_onBeforeLoad"),await this.call("_A_Service_onLoad"),await this.call("_A_Service_onAfterLoad");}catch(t){let e;switch(true){case t instanceof L:e=t;break;case(t instanceof A_Error&&t.originalError instanceof L):e=t.originalError;break;default:e=new L({title:L.ServiceLoadError,description:"An error occurred while processing the request.",originalError:t});break}this.scope.register(e),await this.call("_A_Service_onError");}}async start(){try{await this.call("_A_Service_onBeforeStart"),await this.call("_A_Service_onStart"),await this.call("_A_Service_onAfterStart");}catch(t){let e;switch(true){case t instanceof L:e=t;break;case(t instanceof A_Error&&t.originalError instanceof L):e=t.originalError;break;default:e=new L({title:L.ServiceStartError,description:"An error occurred while processing the request.",originalError:t});break}this.scope.register(e),await this.call("_A_Service_onError");}}async stop(){try{await this.call("_A_Service_onBeforeStop"),await this.call("_A_Service_onStop"),await this.call("_A_Service_onAfterStop");}catch(t){let e;switch(true){case t instanceof L:e=t;break;case(t instanceof A_Error&&t.originalError instanceof L):e=t.originalError;break;default:e=new L({title:L.ServiceStopError,description:"An error occurred while processing the request.",originalError:t});break}this.scope.register(e),await this.call("_A_Service_onError");}}async[Lo="_A_Service_onBeforeLoad"](t,...e){t||(this.scope.register(T),t=this.scope.resolve(T));}async[Po="_A_Service_onLoad"](...t){}async[Ro="_A_Service_onAfterLoad"](...t){}async[vo="_A_Service_onBeforeStart"](...t){}async[wo="_A_Service_onStart"](...t){}async[Co="_A_Service_onAfterStart"](...t){}async[xo="_A_Service_onBeforeStop"](...t){}async[So="_A_Service_onStop"](...t){}async[Ao="_A_Service_onAfterStop"](...t){}async[To="_A_Service_onError"](t,e,...r){e?.error(t);}};i(y,"A_Service"),a([A_Concept.Load()],y.prototype,"load",1),a([A_Concept.Start()],y.prototype,"start",1),a([A_Concept.Stop()],y.prototype,"stop",1),a([A_Feature.Extend(),l(0,A_Inject(T))],y.prototype,Lo,1),a([A_Feature.Extend()],y.prototype,Po,1),a([A_Feature.Extend()],y.prototype,Ro,1),a([A_Feature.Extend()],y.prototype,vo,1),a([A_Feature.Extend()],y.prototype,wo,1),a([A_Feature.Extend()],y.prototype,Co,1),a([A_Feature.Extend()],y.prototype,xo,1),a([A_Feature.Extend()],y.prototype,So,1),a([A_Feature.Extend()],y.prototype,Ao,1),a([A_Feature.Extend({before:/.*/}),l(0,A_Inject(A_Error)),l(1,A_Inject(C))],y.prototype,To,1),y=a([A_Frame.Container({namespace:"A-Utils",name:"A-Service",description:"Service container that manages the lifecycle of various types of services, such as HTTP servers and workers or UI loader. It dynamically loads necessary components based on the provided configuration and orchestrates the start and stop processes, ensuring proper error handling and extensibility through feature hooks."})],y);var ce=class extends A_Fragment{constructor(t){super(),this.url=t instanceof RegExp?t.source:t;}get path(){let t=this.url.split("?")[0].split("#")[0];if(t.includes("://")){let e=t.indexOf("/",t.indexOf("://")+3);if(e===-1)return "/";{let r=t.slice(e);return r.endsWith("/")?r.slice(0,-1):r}}return t.endsWith("/")?t.slice(0,-1):t}get params(){return this.path.match(/:([^\/]+)/g)?.map(t=>t.slice(1))||[]}get protocol(){switch(true){case this.url.startsWith("http://"):return "http";case this.url.startsWith("https://"):return "https";case this.url.startsWith("ws://"):return "ws";case this.url.startsWith("wss://"):return "wss";default:return this.url.includes("://")?this.url.split("://")[0]:"http"}}extractParams(t){let r=t.split("?")[0].split("/").filter(Boolean),o=this.path.split("/").filter(Boolean),n={};for(let s=0;s<o.length;s++){let c=o[s],p=r[s];if(c.startsWith(":")){let m=c.slice(1);n[m]=p;}else if(c!==p)return {}}return n}extractQuery(t){let e={},r=t.split("?")[1];if(!r)return e;let o=r.split("#")[0];for(let n of o.split("&")){if(!n)continue;let[s,c=""]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(c);}return e}toString(){return `${this.path}`}toRegExp(){return new RegExp(`^${this.path.replace(/\/:([^\/]+)/g,"/([^/]+)")}$`)}toAFeatureExtension(t=[]){return new RegExp(`^${t.length?`(${t.join("|")})`:".*"}\\.${this.path.replace(/\/:([^\/]+)/g,"/([^/]+)")}$`)}};i(ce,"A_Route"),ce=a([A_Frame.Fragment({namespace:"A-Utils",name:"A-Route",description:"Route fragment that defines URL patterns for routing purposes. It supports dynamic parameters and query extraction, allowing for flexible route definitions. This fragment can be used in routing systems to match incoming URLs against defined routes and extract relevant parameters and query strings."})],ce);var S=class extends A_Entity{static async default(){}fromJSON(t){super.fromJSON(t),this.data=t.data;}fromNew(t){this.aseid=this.generateASEID({entity:t.name}),this.data=t.data;}toJSON(){return {...super.toJSON(),data:this.data}}};i(S,"A_Signal"),S=a([A_Frame.Entity({namespace:"A-Utils",name:"A-Signal",description:"A Signal Entity represents an individual signal instance that carries data, used for managing state within an application context. Signals are designed to reflect the current state rather than individual events, making them suitable for scenarios where state monitoring and real-time updates are essential."})],S);var X=class extends A_Entity{fromNew(t){super.fromNew(t),this._structure=t.structure,this._signals=t.values;}get structure(){return this._structure||this._signals.map(t=>t.constructor)}get length(){return this.structure.length}[Symbol.iterator](){let t=0,e=this.structure.map(r=>{let o=this._signals.findIndex(n=>n.constructor===r);return o!==-1?this._signals[o]:void 0});return {next(){return t<e.length?{done:false,value:e[t++]}:{done:true,value:void 0}}}}has(t){let e;return t instanceof A_Entity?e=t.constructor:e=t,this.structure.includes(e)}get(t){let e;t instanceof A_Entity?e=t.constructor:e=t;let r=this._signals.findIndex(o=>o.constructor===e);if(r!==-1)return this._signals[r]}async toVector(t){return (t||this.structure).map(r=>{let o=this._signals.findIndex(n=>n.constructor===r);return o!==-1?this._signals[o]:void 0})}async toDataVector(t){let e=t||this.structure,r=[];for(let o of e){let n=this._signals.findIndex(c=>c.constructor===o),s;n===-1?s=await o.default():s=this._signals[n],r.push(s?.toJSON().data);}return r}async toObject(t){let e=t||this.structure,r={};return e.forEach(o=>{let n=o.name,s=this._signals.findIndex(c=>c.constructor===o);if(s!==-1){let c=this._signals[s];r[n]=c.toJSON().data;}else r[n]=void 0;}),r}toJSON(){return {...super.toJSON(),structure:this.structure.map(t=>t.name),values:this._signals.map(t=>t.toJSON())}}};i(X,"A_SignalVector"),X=a([A_Frame.Entity({namespace:"A-Utils",name:"A-SignalVector",description:"A Signal Vector Entity represents a collection of signals structured in a specific way, allowing for batch processing and transmission of related signals as a unified state representation."})],X);var F=class extends A_Fragment{constructor(e){super({name:"A_SignalState"});this._state=new Map;this._prevState=new Map;this._structure=e;}get structure(){return this._structure||[]}set(e,r){let o=e instanceof S?e.constructor:e,n=e instanceof S?e:r;this._prevState.set(o,this._state.get(o)),this._state.set(o,n);}get(e){let r=e instanceof S?e.constructor:e;return this._state.get(r)}getPrev(e){let r=e instanceof S?e.constructor:e;return this._prevState.get(r)}has(e){let r=e instanceof S?e.constructor:e;return this.structure.includes(r)}delete(e){let r=e instanceof S?e.constructor:e;return this._state.delete(r)}toVector(){let e=[];return this._state.forEach((r,o)=>{e.push(r);}),new X({structure:this.structure,values:e})}toObject(){let e={};return this.structure.forEach(r=>{let o=this._state.get(r);if(o===void 0)throw new Error(`Signal ${r.name} has no value in state`);e[r.name]=o;}),e}};i(F,"A_SignalState"),F=a([A_Frame.Fragment({namespace:"A-Utils",name:"A-SignalState",description:"Manages the latest state of all signals within a given scope, maintaining a mapping between signal constructors and their most recently emitted values."})],F);var Y=class extends A_Fragment{get structure(){if(this._structure)return this._structure;let t=A_Context.scope(this);return [...t.allowedEntities].filter(r=>A_CommonHelper.isInheritedFrom(r,S)).sort((r,o)=>r.constructor.name.localeCompare(o.name)).map(r=>t.resolveConstructor(r.name)).filter(r=>r)}get ready(){return this._ready}constructor(t){super({name:"A_SignalConfig"}),this._config=t;}async initialize(){return this._ready||(this._ready=this._initialize()),this._ready}async _initialize(){if(this._config.structure)this._structure=this._config.structure;else if(this._config.stringStructure){let t=this._config.stringStructure.split(",").map(e=>e.trim());this._structure=t.map(e=>A_Context.scope(this).resolveConstructor(e)).filter(e=>e);}}};i(Y,"A_SignalConfig"),Y=a([A_Frame.Fragment({namespace:"A-Utils",name:"A-SignalConfig",description:"Signal configuration fragment that defines the structure and types of signals within a given scope. It allows specifying the expected signal constructors and their order, facilitating consistent signal management and processing across components that emit or listen to signals."})],Y);var Fo=(r=>(r.onBeforeNext="_A_SignalBusFeatures_onBeforeNext",r.onNext="_A_SignalBusFeatures_onNext",r.onError="_A_SignalBusFeatures_onError",r))(Fo||{});var Ge=class Ge extends A_Error{};i(Ge,"A_SignalBusError"),Ge.SignalProcessingError="Signal processing error";var te=Ge;var Bo,Vo,Ho,k=class extends A_Component{async next(...t){let e=new A_Scope({name:"A_SignalBus-Next-Scope",entities:t}).inherit(A_Context.scope(this));try{await this.call("_A_SignalBusFeatures_onBeforeNext",e),await this.call("_A_SignalBusFeatures_onNext",e),e.destroy();}catch(r){let o;switch(true){case r instanceof te:o=r;break;case(r instanceof A_Error&&r.originalError instanceof te):o=r.originalError;break;default:o=new te({title:te.SignalProcessingError,description:"An error occurred while processing the signal.",originalError:r});break}e.register(o),await this.call("_A_SignalBusFeatures_onError"),e.destroy();}}async[Ho="_A_SignalBusFeatures_onError"](t,e,...r){e?.error(t);}async[Vo="_A_SignalBusFeatures_onBeforeNext"](t,e,r,o,n){let s=A_Context.scope(this);n||(n=new Y({stringStructure:e?.get("A_SIGNAL_VECTOR_STRUCTURE")||void 0}),s.register(n)),n.ready||await n.initialize(),r||(r=new F(n.structure),s.register(r));}async[Bo="_A_SignalBusFeatures_onNext"](t,e,r,o,n,s){for(let p of t){if(!r.has(p))return;n?.debug(`A_SignalBus: Updating state for signal '${p.constructor.name}' with data:`,p.data),r.set(p);}let c=r.toVector();e.register(c);}};i(k,"A_SignalBus"),a([A_Frame.Method({description:"Emit multiple signals through the signal bus."})],k.prototype,"next",1),a([A_Feature.Extend({before:/.*/}),l(0,A_Inject(A_Error)),l(1,A_Inject(C))],k.prototype,Ho,1),a([A_Feature.Extend({scope:[k],before:/.*/}),l(0,A_Inject(A_Scope)),l(1,A_Inject(h)),l(2,A_Inject(F)),l(3,A_Inject(C)),l(4,A_Inject(Y))],k.prototype,Vo,1),a([A_Feature.Extend({scope:[k],before:/.*/}),l(0,A_Dependency.Flat()),l(0,A_Dependency.All()),l(0,A_Inject(S)),l(1,A_Inject(A_Scope)),l(2,A_Dependency.Required()),l(2,A_Inject(F)),l(3,A_Inject(h)),l(4,A_Inject(C)),l(5,A_Inject(Y))],k.prototype,Bo,1),k=a([A_Frame.Component({namespace:"A-Utils",name:"A-SignalBus",description:"Signal bus component that manages the emission and state of signals within a given scope. It listens for emitted signals, updates their state, and forwards them to registered watchers. The bus ensures a consistent signal vector structure based on the defined configuration, facilitating signal management across multiple components."})],k);var ct=class ct{constructor(){this.promise=new Promise((t,e)=>{this.resolveFn=t,this.rejectFn=e;});}resolve(t){this.resolveFn(t);}reject(t){this.rejectFn(t);}};i(ct,"A_Deferred");var Se=ct;var lt=class lt{constructor(t,e,r){this.config={resolveOnClear:false};r&&(this.config={...this.config,...r}),this.deferred=new Se,this.timeout=setTimeout(()=>e().then((...o)=>this.deferred.resolve(...o)).catch((...o)=>this.deferred.reject(...o)),t);}get promise(){return this.deferred.promise}clear(){this.timeout&&(clearTimeout(this.timeout),this.config.resolveOnClear?this.deferred.resolve(void 0):this.deferred.reject(new A_Error("Timeout Cleared")));}};i(lt,"A_ScheduleObject");var he=lt;var le=class extends A_Component{async schedule(t,e,r){let o=A_TypeGuards.isString(t)?new Date(t).getTime():t;return new he(o-Date.now(),e,r)}async delay(t,e,r){return new he(t,e,r)}};i(le,"A_Schedule"),le=a([A_Frame.Component({namespace:"A-Utils",name:"A-Schedule",description:"Scheduling component that allows scheduling of callbacks to be executed at specific times or after certain delays. It provides methods to schedule callbacks based on Unix timestamps or ISO date strings, as well as a method to execute callbacks after a specified delay in milliseconds. This component is useful for managing timed operations within an application."})],le);
export{zn as A_CONSTANTS__CONFIG_ENV_VARIABLES,_e as A_CONSTANTS__CONFIG_ENV_VARIABLES_ARRAY,I as A_Channel,oe as A_ChannelError,kt as A_ChannelFeatures,H as A_ChannelRequest,Mt as A_ChannelRequestStatuses,A as A_Command,q as A_CommandError,zt as A_CommandEvent,Yt as A_CommandFeatures,Ft as A_CommandTransitions,$t as A_Command_Status,h as A_Config,B as A_ConfigError,Q as A_ConfigLoader,Se as A_Deferred,R as A_ExecutionContext,Z as A_LOGGER_ANSI,ut as A_LOGGER_COLORS,ti as A_LOGGER_DEFAULT_LEVEL,dt as A_LOGGER_DEFAULT_SCOPE_LENGTH,Ee as A_LOGGER_ENV_KEYS,x as A_LOGGER_FORMAT,gt as A_LOGGER_SAFE_RANDOM_COLORS,de as A_LOGGER_TERMINAL,me as A_LOGGER_TIME_FORMAT,C as A_Logger,ke as A_LoggerEnvVariables,Us as A_LoggerEnvVariablesArray,ae as A_Manifest,ue as A_ManifestChecker,ee as A_ManifestError,v as A_Memory,w as A_MemoryContext,f as A_MemoryError,eo as A_MemoryFeatures,d as A_OperationContext,T as A_Polyfill,ce as A_Route,le as A_Schedule,he as A_ScheduleObject,y as A_Service,ho as A_ServiceFeatures,S as A_Signal,k as A_SignalBus,te as A_SignalBusError,Fo as A_SignalBusFeatures,Y as A_SignalConfig,F as A_SignalState,X as A_SignalVector,E as A_StateMachine,pe as A_StateMachineError,Ht as A_StateMachineFeatures,P as A_StateMachineTransition,Jr as A_TYPES__ConfigFeature,b as ConfigReader,G as ENVConfigReader,j as FileConfigReader};//# sourceMappingURL=index.mjs.map
//# sourceMappingURL=index.mjs.map
{"version":3,"sources":["../../src/lib/A-Schedule/A-Deferred.class.ts","../../src/lib/A-Schedule/A-ScheduleObject.class.ts","../../src/lib/A-Schedule/A-Schedule.component.ts"],"names":[],"mappings":";;;;;AAAO,IAAM,aAAN,MAAoB;AAAA;AAAA;AAAA;AAAA;AAAA,EASvB,WAAA,GAAc;AACV,IAAA,IAAA,CAAK,OAAA,GAAU,IAAI,OAAA,CAAW,CAAC,SAAS,MAAA,KAAW;AAC/C,MAAA,IAAA,CAAK,SAAA,GAAY,OAAA;AACjB,MAAA,IAAA,CAAK,QAAA,GAAW,MAAA;AAAA,IACpB,CAAC,CAAA;AAAA,EACL;AAAA,EAEA,QAAQ,KAAA,EAAiC;AACrC,IAAA,IAAA,CAAK,UAAU,KAAK,CAAA;AAAA,EACxB;AAAA,EAEA,OAAO,MAAA,EAAoB;AACvB,IAAA,IAAA,CAAK,SAAS,MAAM,CAAA;AAAA,EACxB;AACJ;ACnBO,IAAM,mBAAN,MAA4C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAwB/C,WAAA,CAII,EAAA,EAIA,MAAA,EAIA,MAAA,EACF;AAhCF,IAAA,IAAA,CAAQ,MAAA,GAA8C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAOlD,cAAA,EAAgB;AAAA,KACpB;AAyBI,IAAA,IAAI,MAAA;AACA,MAAA,IAAA,CAAK,SAAS,EAAE,GAAG,IAAA,CAAK,MAAA,EAAQ,GAAG,MAAA,EAAO;AAE9C,IAAA,IAAA,CAAK,QAAA,GAAW,IAAI,UAAA,EAAc;AAElC,IAAA,IAAA,CAAK,OAAA,GAAU,UAAA;AAAA,MACX,MAAM,QAAO,CACR,IAAA,CAAK,IAAI,IAAA,KAAS,IAAA,CAAK,SAAS,OAAA,CAAQ,GAAG,IAAI,CAAC,CAAA,CAChD,MAAM,CAAA,GAAI,IAAA,KAAS,KAAK,QAAA,CAAS,MAAA,CAAO,GAAG,IAAI,CAAC,CAAA;AAAA,MACrD;AAAA,KACJ;AAAA,EACJ;AAAA,EAEA,IAAI,OAAA,GAAsB;AACtB,IAAA,OAAO,KAAK,QAAA,CAAS,OAAA;AAAA,EACzB;AAAA,EAEA,KAAA,GAAc;AACV,IAAA,IAAI,KAAK,OAAA,EAAS;AACd,MAAA,YAAA,CAAa,KAAK,OAAO,CAAA;AAEzB,MAAA,IAAI,KAAK,MAAA,CAAO,cAAA;AACZ,QAAA,IAAA,CAAK,QAAA,CAAS,QAAQ,MAAc,CAAA;AAAA;AAEpC,QAAA,IAAA,CAAK,QAAA,CAAS,MAAA,CAAO,IAAI,OAAA,CAAQ,iBAAiB,CAAC,CAAA;AAAA,IAC3D;AAAA,EACJ;AACJ;ACxDO,IAAM,UAAA,GAAN,cAAyB,WAAA,CAAY;AAAA,EAqCxC,MAAM,QAAA,CACF,IAAA,EACA,QAAA,EACA,MAAA,EAC4B;AAE5B,IAAA,MAAM,SAAA,GAAY,YAAA,CAAa,QAAA,CAAS,IAAI,CAAA,GACrC,IAAI,IAAA,CAAK,IAAI,CAAA,CAAG,OAAA,EAAQ,GACzB,IAAA;AAEN,IAAA,OAAO,IAAI,gBAAA;AAAA,MACP,SAAA,GAAY,KAAK,GAAA,EAAI;AAAA,MACrB,QAAA;AAAA,MACA;AAAA,KACJ;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,MAAM,KAAA,CAIF,EAAA,EAIA,QAAA,EAIA,MAAA,EAC4B;AAC5B,IAAA,OAAO,IAAI,gBAAA;AAAA,MACP,EAAA;AAAA,MACA,QAAA;AAAA,MACA;AAAA,KACJ;AAAA,EACJ;AACJ;AAlFa,UAAA,GAAN,eAAA,CAAA;AAAA,EALN,QAAQ,SAAA,CAAU;AAAA,IACf,SAAA,EAAW,SAAA;AAAA,IACX,IAAA,EAAM,YAAA;AAAA,IACN,WAAA,EAAa;AAAA,GAChB;AAAA,CAAA,EACY,UAAA,CAAA","file":"a-schedule.mjs","sourcesContent":["export class A_Deferred<T> {\n    public promise: Promise<T>;\n    private resolveFn!: (value: T | PromiseLike<T>) => void;\n    private rejectFn!: (reason?: any) => void;\n\n    /**\n     * Creates a deferred promise\n     * @returns A promise that can be resolved or rejected later\n     */\n    constructor() {\n        this.promise = new Promise<T>((resolve, reject) => {\n            this.resolveFn = resolve;\n            this.rejectFn = reject;\n        });\n    }\n\n    resolve(value: T | PromiseLike<T>): void {\n        this.resolveFn(value);\n    }\n\n    reject(reason?: any): void {\n        this.rejectFn(reason);\n    }\n}","import { A_Deferred } from \"./A-Deferred.class\";\nimport { A_Error } from \"@adaas/a-concept\";\nimport { A_UTILS_TYPES__ScheduleObjectCallback, A_UTILS_TYPES__ScheduleObjectConfig } from \"./A-Schedule.types\";\n\nexport class A_ScheduleObject<T extends any = any> {\n\n    private timeout!: NodeJS.Timeout;\n    private deferred!: A_Deferred<T>;\n\n    private config: A_UTILS_TYPES__ScheduleObjectConfig = {\n        /**\n         * If the timeout is cleared, should the promise resolve or reject?\n         * BY Default it rejects\n         * \n         * !!!NOTE: If the property is set to true, the promise will resolve with undefined\n         */\n        resolveOnClear: false\n    };\n\n\n    /**\n     * Creates a scheduled object that will execute the action after specified milliseconds\n     * \n     * \n     * @param ms - milliseconds to wait before executing the action\n     * @param action - the action to execute\n     * @param config - configuration options for the schedule object\n     */\n    constructor(\n        /**\n         * Milliseconds to wait before executing the action\n         */\n        ms: number,\n        /**\n         * The action to execute after the specified milliseconds\n         */\n        action: A_UTILS_TYPES__ScheduleObjectCallback<T>,\n        /**\n         * Configuration options for the schedule object\n         */\n        config?: A_UTILS_TYPES__ScheduleObjectConfig\n    ) {\n        if (config)\n            this.config = { ...this.config, ...config };\n\n        this.deferred = new A_Deferred<T>();\n\n        this.timeout = setTimeout(\n            () => action()\n                .then((...args) => this.deferred.resolve(...args))\n                .catch((...args) => this.deferred.reject(...args)),\n            ms\n        );\n    }\n\n    get promise(): Promise<T> {\n        return this.deferred.promise;\n    }\n\n    clear(): void {\n        if (this.timeout) {\n            clearTimeout(this.timeout);\n\n            if (this.config.resolveOnClear)\n                this.deferred.resolve(undefined as T);\n            else\n                this.deferred.reject(new A_Error(\"Timeout Cleared\"));\n        }\n    }\n}\n\n","import { A_Component, A_Fragment, A_TypeGuards } from \"@adaas/a-concept\";\nimport { A_ScheduleObject } from \"./A-ScheduleObject.class\";\nimport { A_UTILS_TYPES__ScheduleObjectCallback, A_UTILS_TYPES__ScheduleObjectConfig } from \"./A-Schedule.types\";\nimport { A_Frame } from \"@adaas/a-frame\";\n\n\n\n\n@A_Frame.Component({\n    namespace: 'A-Utils',\n    name: 'A-Schedule',\n    description: 'Scheduling component that allows scheduling of callbacks to be executed at specific times or after certain delays. It provides methods to schedule callbacks based on Unix timestamps or ISO date strings, as well as a method to execute callbacks after a specified delay in milliseconds. This component is useful for managing timed operations within an application.'\n})\nexport class A_Schedule extends A_Component {\n\n    /**\n     * Allows to schedule a callback for particular time in the future\n     * \n     * @param timestamp - Unix timestamp in milliseconds\n     * @param callback - The callback to execute\n     * @returns A promise that resolves to the schedule object\n     */\n    async schedule<T extends any = any>(\n        /**\n         * Unix timestamp in milliseconds\n         */\n        timestamp: number,\n        /**\n         * The callback to execute\n         */\n        callback: A_UTILS_TYPES__ScheduleObjectCallback<T>,\n        /**\n         * Configuration options for the schedule object\n         */\n        config?: A_UTILS_TYPES__ScheduleObjectConfig\n    ): Promise<A_ScheduleObject<T>>\n    async schedule<T extends any = any>(\n        /**\n         * ISO date string representing the date and time to schedule the callback for\n         */\n        date: string,\n        /**\n         * The callback to execute\n         */\n        callback: A_UTILS_TYPES__ScheduleObjectCallback<T>,\n        /**\n        * Configuration options for the schedule object\n        */\n        config?: A_UTILS_TYPES__ScheduleObjectConfig\n    ): Promise<A_ScheduleObject<T>>\n    async schedule<T extends any = any>(\n        date: string | number,\n        callback: A_UTILS_TYPES__ScheduleObjectCallback<T>,\n        config?: A_UTILS_TYPES__ScheduleObjectConfig\n    ): Promise<A_ScheduleObject<T>> {\n\n        const timestamp = A_TypeGuards.isString(date)\n            ? (new Date(date)).getTime()\n            : date;\n\n        return new A_ScheduleObject<T>(\n            timestamp - Date.now(),\n            callback,\n            config\n        );\n    }\n\n\n\n    /**\n     * Allows to execute callback after particular delay in milliseconds\n     * So the callback will be executed after the specified delay\n     * \n     * @param ms \n     */\n    async delay<T extends any = any>(\n        /**\n         * Delay in milliseconds\n         */\n        ms: number,\n        /**\n         * The callback to execute after the delay\n         */\n        callback: A_UTILS_TYPES__ScheduleObjectCallback<T>,\n        /**\n        * Configuration options for the schedule object\n        */\n        config?: A_UTILS_TYPES__ScheduleObjectConfig\n    ): Promise<A_ScheduleObject<T>> {\n        return new A_ScheduleObject<T>(\n            ms,\n            callback,\n            config\n        );\n    }\n}"]}
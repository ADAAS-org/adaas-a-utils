{"version":3,"sources":["../../../../src/lib/A-Command/A-Command.entity.ts"],"names":["A_Command","A_Entity","A_ExecutionContext","A_Command_Status","A_StateMachineFeatures","A_CommandTransitions","A_CommandEvent","A_CommandFeatures","A_Feature","A_Error","A_CommandError","A_Scope","A_StateMachine","A_Context","A_StateMachineTransition","A_Logger","A_Frame"],"mappings":"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","file":"A-Command.entity.js","sourcesContent":["import {\n    A_Command_ExecutionContext,\n    A_TYPES__Command_Init,\n    A_TYPES__Command_Listener,\n    A_TYPES__Command_Serialized\n} from \"./A-Command.types\";\nimport {\n    A_CommandFeatures,\n    A_Command_Status,\n    A_CommandTransitions,\n    A_CommandEvent\n} from \"./A-Command.constants\";\nimport { A_Context, A_Dependency, A_Entity, A_Error, A_Feature, A_Inject, A_Scope } from \"@adaas/a-concept\";\nimport { A_CommandError } from \"./A-Command.error\";\nimport { A_StateMachine, A_StateMachineFeatures, A_StateMachineTransition } from \"@adaas/a-utils/a-state-machine\";\nimport { A_Logger } from \"@adaas/a-utils/a-logger\";\nimport { A_ExecutionContext } from \"@adaas/a-utils/a-execution\";\nimport { A_Frame } from \"@adaas/a-frame\";\n\n/**\n * A_Command - Advanced Command Pattern Implementation\n * \n * A comprehensive command pattern implementation that encapsulates business logic\n * as executable commands with full lifecycle management, event handling, and \n * state persistence capabilities.\n * \n * ## Key Features\n * - **Structured Lifecycle**: Automatic progression through init → compile → execute → complete/fail\n * - **Event-Driven**: Subscribe to lifecycle events and emit custom events\n * - **State Persistence**: Full serialization/deserialization for cross-service communication\n * - **Type Safety**: Generic types for parameters, results, and custom events\n * - **Dependency Injection**: Integrated with A-Concept's DI system\n * - **Error Management**: Comprehensive error capture and handling\n * - **Execution Tracking**: Built-in timing and performance metrics\n * \n * ## Lifecycle Phases\n * 1. **CREATED** - Command instantiated but not initialized\n * 2. **INITIALIZED** - Execution scope and dependencies set up\n * 3. **COMPILED** - Ready for execution with all resources prepared\n * 4. **EXECUTING** - Currently running business logic\n * 5. **COMPLETED** - Successfully finished execution\n * 6. **FAILED** - Execution failed with errors captured\n * \n * @template InvokeType - Type definition for command parameters\n * @template ResultType - Type definition for command execution result\n * @template LifecycleEvents - Union type of custom lifecycle event names\n * \n * @example\n * ```typescript\n * // Define parameter and result types\n * interface UserCreateParams {\n *   name: string;\n *   email: string;\n *   role: 'admin' | 'user';\n * }\n * \n * interface UserCreateResult {\n *   userId: string;\n *   success: boolean;\n * }\n * \n * // Create custom command\n * class CreateUserCommand extends A_Command<UserCreateParams, UserCreateResult> {}\n * \n * // Execute command\n * const command = new CreateUserCommand({\n *   name: 'John Doe',\n *   email: 'john@example.com',\n *   role: 'user'\n * });\n * \n * scope.register(command);\n * await command.execute();\n * \n * console.log('Result:', command.result);\n * console.log('Status:', command.status);\n * ```\n */\n@A_Frame.Entity({\n    namespace: 'A-Utils',\n    name: 'A-Command',\n    description: 'Advanced Command Pattern Implementation with full lifecycle management, event handling, and state persistence. This entity allows to execute commands in distributed environment across multiple services.'\n})\nexport class A_Command<\n    InvokeType extends A_TYPES__Command_Init = A_TYPES__Command_Init,\n    ResultType extends Record<string, any> = Record<string, any>,\n    LifecycleEvents extends string | keyof typeof A_CommandEvent = keyof typeof A_CommandEvent,\n> extends A_Entity<InvokeType, A_TYPES__Command_Serialized<InvokeType, ResultType>> {\n\n    // ====================================================================\n    // ================== Static Command Information ======================\n    // ====================================================================\n\n    /**\n     * Static command identifier derived from the class name\n     * Used for command registration and serialization\n     */\n    static get code(): string {\n        return super.entity;\n    }\n\n    // ====================================================================\n    // ================== Instance Properties =============================\n    // ====================================================================\n\n    /** The origin of the command, used to know has it been created from serialization or invoked */\n    protected _origin!: 'invoked' | 'serialized';\n\n    /** Command execution scope for dependency injection and feature resolution */\n    protected _executionScope!: A_Scope;\n\n    /** Result data produced by successful command execution */\n    protected _result?: ResultType;\n\n    /** Set of errors that occurred during command execution */\n    protected _error!: A_Error;\n\n    /** Command initialization parameters */\n    protected _params!: InvokeType;\n\n    /** Current lifecycle status of the command */\n    protected _status!: A_Command_Status\n\n    /** Map of event listeners organized by event name */\n    protected _listeners: Map<\n        LifecycleEvents | keyof typeof A_CommandEvent,\n        Set<A_TYPES__Command_Listener<InvokeType, ResultType, LifecycleEvents>>\n    > = new Map();\n\n    /** Timestamp when command execution started */\n    protected _startTime?: Date;\n\n    /** Timestamp when command execution ended */\n    protected _endTime?: Date;\n\n    /** Timestamp when command was created */\n    protected _createdAt!: Date;\n\n\n    // ====================================================================\n    // ================== Public Getter Properties =======================\n    // ====================================================================\n\n    /**\n     * Total execution duration in milliseconds\n     * \n     * - If completed/failed: Returns total time from start to end\n     * - If currently executing: Returns elapsed time since start\n     * - If not started: Returns undefined\n     */\n    get duration(): number | undefined {\n        return this._endTime && this._startTime\n            ? this._endTime.getTime() - this._startTime.getTime()\n            : this._startTime\n                ? new Date().getTime() - this._startTime.getTime()\n                : undefined;\n    }\n\n    /**\n     * Idle time before execution started in milliseconds\n     * \n     * Time between command creation and execution start.\n     * Useful for monitoring command queue performance.\n     */\n    get idleTime(): number | undefined {\n        return this._startTime && this._createdAt\n            ? this._startTime.getTime() - this._createdAt.getTime()\n            : undefined;\n    }\n\n    /**\n     * Command execution scope for dependency injection\n     * \n     * Provides access to components, services, and shared resources\n     * during command execution. Inherits from the scope where the\n     * command was registered.\n     */\n    get scope(): A_Scope {\n        return this._executionScope;\n    }\n    /**\n     * Execution context associated with the command\n     */\n    get context(): A_ExecutionContext<A_Command_ExecutionContext<InvokeType, ResultType>> {\n        return this.scope.resolve(A_ExecutionContext<A_Command_ExecutionContext<InvokeType, ResultType>>)!;\n    }\n\n    /**\n     * Unique command type identifier\n     * \n     * Derived from the class name and used for:\n     * - Command registration and resolution\n     * - Serialization and deserialization\n     * - Logging and debugging\n     * \n     * @example 'create-user-command', 'process-order-command'\n     */\n    get code(): string {\n        return (this.constructor as typeof A_Command).code;\n    }\n    /**\n     * Current lifecycle status of the command\n     * \n     * Indicates the current phase in the command execution lifecycle.\n     * Used to track progress and determine available operations.\n     */\n    get status(): A_Command_Status {\n        return this._status;\n    }\n\n    /**\n     * Timestamp when the command was created\n     * \n     * Marks the initial instantiation time, useful for tracking\n     * command age and queue performance metrics.\n     */\n    get createdAt(): Date {\n        return this._createdAt!;\n    }\n\n    /**\n     * Timestamp when command execution started\n     * \n     * Undefined until execution begins. Used for calculating\n     * execution duration and idle time.\n     */\n    get startedAt(): Date | undefined {\n        return this._startTime;\n    }\n\n    /**\n     * Timestamp when command execution ended\n     * \n     * Set when command reaches COMPLETED or FAILED status.\n     * Used for calculating total execution duration.\n     */\n    get endedAt(): Date | undefined {\n        return this._endTime;\n    }\n\n    /**\n     * Result data produced by command execution\n     * \n     * Contains the output data from successful command execution.\n     * Undefined until command completes successfully.\n     */\n    get result(): ResultType | undefined {\n        return this._result;\n    }\n\n    /**\n     * Array of errors that occurred during execution\n     * \n     * Automatically wraps native errors in A_Error instances\n     * for consistent error handling. Empty array if no errors occurred.\n     */\n    get error(): A_Error | undefined {\n        return this._error;\n    }\n\n    /**\n     * Command initialization parameters\n     * \n     * Contains the input data used to create and configure the command.\n     * These parameters are immutable during command execution.\n                    return new A_Error(err);\n                }\n            });\n    }\n\n    /**\n     * Command initialization parameters\n     * \n     * Contains the input data used to create and configure the command.\n     * These parameters are immutable during command execution.\n     */\n    get params(): InvokeType {\n        return this._params;\n    }\n\n    /**\n     * Indicates if the command has been processed (completed or failed)\n     * \n     * Returns true if the command has completed or failed, false otherwise.\n     */\n    get isProcessed(): boolean {\n        return this._status === A_Command_Status.COMPLETED\n            || this._status === A_Command_Status.FAILED;\n    }\n\n    /**\n     * \n     * A-Command represents an executable command with a specific code and parameters.\n     * It can be executed within a given scope and stores execution results and errors.\n     * \n     * \n     * A-Command should be context independent and execution logic should be based on attached components \n     * \n     * @param code \n     * @param params \n     */\n    constructor(\n        /**\n         * Command invocation parameters\n         */\n        params: InvokeType | A_TYPES__Command_Serialized<InvokeType, ResultType> | string,\n    ) {\n        super(params as any);\n    }\n\n    // --------------------------------------------------------------------------\n    // A-StateMachine Feature Extensions\n    // --------------------------------------------------------------------------\n    @A_Feature.Extend()\n    protected async [A_StateMachineFeatures.onBeforeTransition](\n        @A_Inject(A_StateMachineTransition) transition: A_StateMachineTransition,\n        @A_Inject(A_Logger) logger?: A_Logger,\n        ...args: any[]\n    ) {\n        this.checkScopeInheritance();\n\n        //  and register all allowed status transitions\n        //  switch across allowed transitions, if not allowed throw an error\n        logger?.debug('yellow', `Command ${this.aseid.toString()} transitioning from ${transition.from} to ${transition.to}`);\n    }\n\n    @A_Feature.Extend()\n    protected async [A_CommandTransitions.CREATED_TO_INITIALIZED](\n        @A_Inject(A_StateMachineTransition) transition: A_StateMachineTransition,\n        ...args: any[]\n    ): Promise<void> {\n        if (this._status !== A_Command_Status.CREATED) {\n            return;\n        }\n\n        this._createdAt = new Date();\n        this._status = A_Command_Status.INITIALIZED;\n\n        this.emit(A_CommandEvent.onInit);\n    }\n\n    @A_Feature.Extend()\n    protected async [A_CommandTransitions.INITIALIZED_TO_EXECUTING](\n        @A_Inject(A_StateMachineTransition) transition: A_StateMachineTransition,\n        ...args: any[]\n    ): Promise<void> {\n        if (this._status !== A_Command_Status.INITIALIZED\n            && this._status !== A_Command_Status.CREATED\n        ) {\n            return;\n        }\n\n        this._startTime = new Date();\n        this._status = A_Command_Status.EXECUTING;\n\n        this.emit(A_CommandEvent.onExecute);\n    }\n\n    @A_Feature.Extend()\n    /**\n     * Handles command completion after successful execution\n     * \n     * EXECUTION -> COMPLETED transition\n     */\n    protected async [A_CommandTransitions.EXECUTING_TO_COMPLETED](\n        @A_Inject(A_StateMachineTransition) transition: A_StateMachineTransition,\n        ...args: any[]\n    ): Promise<void> {\n        this._endTime = new Date();\n        this._status = A_Command_Status.COMPLETED;\n\n        this.emit(A_CommandEvent.onComplete);\n    }\n\n    @A_Feature.Extend()\n    /**\n     * Handles command failure during execution\n     * \n     * EXECUTION -> FAILED transition\n     */\n    protected async [A_CommandTransitions.EXECUTING_TO_FAILED](\n        @A_Inject(A_StateMachineTransition) transition: A_StateMachineTransition,\n        @A_Inject(A_Error) error: A_Error,\n        ...args: any[]\n    ): Promise<void> {\n        this._endTime = new Date();\n\n        this._status = A_Command_Status.FAILED;\n\n        this.emit(A_CommandEvent.onFail);\n    }\n\n\n    // --------------------------------------------------------------------------\n    // A-Command Lifecycle Feature Extensions\n    // --------------------------------------------------------------------------\n    @A_Feature.Extend()\n    /**\n     * Default behavior for Command Initialization uses StateMachine to transition states\n     */\n    protected async [A_CommandFeatures.onInit](\n        @A_Inject(A_StateMachine) stateMachine: A_StateMachine,\n        ...args: any[]\n    ): Promise<void> {\n        await stateMachine.transition(A_Command_Status.CREATED, A_Command_Status.INITIALIZED);\n    }\n\n    @A_Feature.Extend({\n        after: /.*/\n    })\n    protected async [A_CommandFeatures.onBeforeExecute](\n        @A_Dependency.Required()\n        @A_Inject(A_StateMachine) stateMachine: A_StateMachine,\n        ...args: any[]\n    ): Promise<void> {\n        await stateMachine.transition(A_Command_Status.INITIALIZED, A_Command_Status.EXECUTING);\n    }\n\n    @A_Feature.Extend()\n    protected async [A_CommandFeatures.onExecute](\n        ...args: any[]\n    ): Promise<void> {\n    }\n\n    @A_Feature.Extend()\n    /**\n     * By Default on AfterExecute calls the Completion method to mark the command as completed\n     * \n     * [!] This can be overridden to implement custom behavior using A_Feature overrides\n     */\n    protected async [A_CommandFeatures.onAfterExecute](\n        ...args: any[]\n    ): Promise<void> {\n    }\n\n    @A_Feature.Extend({\n        after: /.*/\n    })\n    protected async [A_CommandFeatures.onComplete](\n        @A_Inject(A_StateMachine) stateMachine: A_StateMachine,\n        ...args: any[]\n    ): Promise<void> {\n        await stateMachine.transition(A_Command_Status.EXECUTING, A_Command_Status.COMPLETED);\n    }\n\n    @A_Feature.Extend({\n        after: /.*/\n    })\n    protected async [A_CommandFeatures.onFail](\n        @A_Dependency.Required()\n        @A_Inject(A_StateMachine) stateMachine: A_StateMachine,\n        @A_Inject(A_ExecutionContext) operation: A_ExecutionContext<A_Command_ExecutionContext<InvokeType, ResultType>>,\n        ...args: any[]\n    ): Promise<void> {\n        await stateMachine.transition(A_Command_Status.EXECUTING, A_Command_Status.FAILED);\n    }\n\n    // --------------------------------------------------------------------------\n    // A-Command Lifecycle Methods\n    // --------------------------------------------------------------------------\n    /**\n     * Initializes the command before execution.\n     */\n    async init(): Promise<void> {\n        await this.call(A_CommandFeatures.onInit, this.scope);\n    }\n\n    /**\n     * Executes the command logic.\n     */\n    async execute(): Promise<any> {\n\n        if (this.isProcessed) return;\n\n        try {\n            this.checkScopeInheritance();\n\n            const context = new A_ExecutionContext<A_Command_ExecutionContext<InvokeType, ResultType>>('execute-command');\n\n            this.scope.register(context);\n\n            await new Promise<void>(async (resolve, reject) => {\n\n                try {\n                    const onBeforeExecuteFeature = new A_Feature({\n                        name: A_CommandFeatures.onBeforeExecute,\n                        component: this,\n                        scope: this.scope\n                    })\n\n                    const onExecuteFeature = new A_Feature({\n                        name: A_CommandFeatures.onExecute,\n                        component: this,\n                        scope: this.scope\n                    })\n\n                    const onAfterExecuteFeature = new A_Feature({\n                        name: A_CommandFeatures.onAfterExecute,\n                        component: this,\n                        scope: this.scope\n                    })\n\n\n\n                    this.on(A_CommandEvent.onComplete, () => {\n\n                        onBeforeExecuteFeature.interrupt();\n                        onExecuteFeature.interrupt();\n                        onAfterExecuteFeature.interrupt();\n\n                        resolve();\n                    });\n\n                    this.on(A_CommandEvent.onFail, () => {\n\n                        onBeforeExecuteFeature.interrupt();\n                        onExecuteFeature.interrupt();\n                        onAfterExecuteFeature.interrupt();\n\n                        reject(this.error);\n                    });\n\n\n                    await onBeforeExecuteFeature.process(this.scope);\n\n                    await onExecuteFeature.process(this.scope);\n\n                    await onAfterExecuteFeature.process(this.scope);\n\n                    /** only in case it was really invoked we automatically transit it to COMPLETED state */\n                    if (this._origin === 'invoked') {\n                        await this.complete();\n                    }\n\n                    resolve();\n\n                } catch (error) {\n                    reject(error);\n                }\n            });\n\n        } catch (error) {\n            let targetError = error instanceof A_Error\n                ? error\n                : new A_CommandError({\n                    title: A_CommandError.ExecutionError,\n                    description: `An error occurred while executing command \"${this.aseid.toString()}\".`,\n                    originalError: error\n                });\n\n            await this.fail(targetError);\n        }\n    }\n\n    /**\n     * Marks the command as completed\n     * \n     * \n     * Calling This method will set the command status to COMPLETED, record the end time,\n     * store the result, emit the onComplete event, and destroy the execution scope.\n     *\n     * [!] After Calling this method, the command is considered fully processed And further processing will be INTERRUPTED. \n     * [!] If the command is already processed (COMPLETED or FAILED), this method does nothing.\n     * [!] This method can be called with optional result data to store with the command.\n     * \n     * @param result - Optional result data to store with the command\n     */\n    async complete(result?: ResultType) {\n        if (this.isProcessed) return;\n\n        this._status = A_Command_Status.COMPLETED;\n\n        this._result = result;\n\n        await this.call(A_CommandFeatures.onComplete, this.scope);\n\n        this.scope.destroy();\n    }\n\n\n\n    /**\n     * Marks the command as failed\n     */\n    async fail(error?: A_Error) {\n        if (this.isProcessed) return;\n\n        this._status = A_Command_Status.FAILED;\n        if (error) {\n            this._error = error;\n            this.scope.register(error);\n        }\n\n        await this.call(A_CommandFeatures.onFail, this.scope);\n\n        this.scope.destroy();\n    }\n\n\n    // --------------------------------------------------------------------------   \n    // A-Command Event-Emitter methods\n    // --------------------------------------------------------------------------\n\n    /**\n     * Registers an event listener for a specific event\n     * \n     * @param event \n     * @param listener \n     */\n    on(event: LifecycleEvents | A_CommandEvent, listener: A_TYPES__Command_Listener<InvokeType, ResultType, LifecycleEvents>) {\n        if (!this._listeners.has(event)) {\n            this._listeners.set(event, new Set());\n        }\n        this._listeners.get(event)!.add(listener);\n    }\n    /**\n     * Removes an event listener for a specific event\n     * \n     * @param event \n     * @param listener \n     */\n    off(event: LifecycleEvents | A_CommandEvent, listener: A_TYPES__Command_Listener<InvokeType, ResultType, LifecycleEvents>) {\n        this._listeners.get(event)?.delete(listener);\n    }\n    /**\n     * Emits an event to all registered listeners\n     * \n     * @param event \n     */\n    emit(event: LifecycleEvents | keyof typeof A_CommandEvent) {\n        this._listeners.get(event)?.forEach(async listener => {\n            listener(this);\n        });\n    }\n\n\n    // --------------------------------------------------------------------------\n    // A-Entity Base Class Overrides\n    // --------------------------------------------------------------------------\n    // Serialization / Deserialization\n    // -------------------------------------------------------------------------\n\n\n    /**\n     * Allows to create a Command instance from new data\n     * \n     * @param newEntity \n     */\n    fromNew(newEntity: InvokeType): void {\n        super.fromNew(newEntity);\n\n        this._origin = 'invoked';\n\n        this._executionScope = new A_Scope({\n            name: `A-Command-Execution-Scope-${this.aseid.toString()}`,\n            components: [A_StateMachine],\n        });\n\n        this._createdAt = new Date();\n\n        this._params = newEntity;\n\n        this._status = A_Command_Status.CREATED;\n    }\n\n\n\n    /**\n     * Allows to convert serialized data to Command instance\n     * \n     * [!] By default it omits params as they are not stored in the serialized data\n     * \n     * @param serialized \n     */\n    fromJSON(serialized: A_TYPES__Command_Serialized<InvokeType, ResultType>): void {\n        super.fromJSON(serialized);\n\n        this._origin = 'serialized';\n\n        this._executionScope = new A_Scope({\n            name: `A-Command-Execution-Scope-${this.aseid.toString()}`,\n            components: [A_StateMachine],\n        });\n\n        if (serialized.createdAt) this._createdAt = new Date(serialized.createdAt);\n        if (serialized.startedAt) this._startTime = new Date(serialized.startedAt);\n        if (serialized.endedAt) this._endTime = new Date(serialized.endedAt);\n\n        this._params = serialized.params\n        this._status = serialized.status;\n\n        if (serialized.error)\n            this._error = new A_CommandError(serialized.error)\n\n        if (serialized.result)\n            this._result = serialized.result;\n    }\n\n\n    /**\n     * Converts the Command instance to a plain object\n     * \n     * @returns \n     */\n    toJSON(): A_TYPES__Command_Serialized<InvokeType, ResultType> {\n        return {\n            ...super.toJSON(),\n            code: this.code,\n            status: this._status,\n            params: this._params,\n            createdAt: this._createdAt.toISOString(),\n            startedAt: this._startTime ? this._startTime.toISOString() : undefined,\n            endedAt: this._endTime ? this._endTime.toISOString() : undefined,\n            duration: this.duration,\n            idleTime: this.idleTime,\n            result: this.result,\n            error: this.error ? this.error.toJSON() : undefined,\n        }\n    };\n\n\n    //============================================================================================\n    //                                Helpers Methods\n    //============================================================================================\n    /**\n     * Ensures that the command's execution scope inherits from the context scope\n     * \n     * Throws an error if the command is not bound to any context scope\n     */\n    protected checkScopeInheritance(): void {\n        let attachedScope: A_Scope;\n\n        try {\n            attachedScope = A_Context.scope(this);\n        } catch (error) {\n            throw new A_CommandError({\n                title: A_CommandError.CommandScopeBindingError,\n                description: `Command ${this.aseid.toString()} is not bound to any context scope. Ensure the command is properly registered within a context before execution.`,\n                originalError: error\n            });\n        }\n\n        if (!this.scope.isInheritedFrom(A_Context.scope(this))) {\n            this.scope.inherit(A_Context.scope(this));\n        }\n    }\n}\n\n"]}
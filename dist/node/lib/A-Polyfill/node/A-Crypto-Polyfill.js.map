{"version":3,"sources":["../../../../../src/lib/A-Polyfill/node/A-Crypto-Polyfill.ts"],"names":["A_CryptoPolyfillBase","crypto"],"mappings":";;;;;;;;;AAIO,MAAM,yBAAyBA,yCAAA,CAAqB;AAAA,EACvD,YAAY,MAAA,EAAkB;AAC1B,IAAA,KAAA,CAAM,MAAM,CAAA;AAAA,EAChB;AAAA,EAEA,MAAgB,kBAAA,GAAoC;AAChD,IAAA,IAAA,CAAK,OAAA,GAAU;AAAA,MACX,cAAA,EAAgB,CAAC,IAAA,EAAc,SAAA,GAAoB,aAAa,OAAA,CAAQ,OAAA;AAAA,QACpE,CAAA,EAAG,SAAS,CAAA,CAAA,EAAIC,uBAAA,CAAO,UAAA,CAAW,SAAS,CAAA,CAAE,MAAA,CAAO,IAAI,CAAA,CAAE,MAAA,CAAO,QAAQ,CAAC,CAAA;AAAA,OAC9E;AAAA,MACA,cAAA,EAAgB,CAAC,QAAA,EAAkB,SAAA,GAAoB,aAAa,IAAI,OAAA,CAAQ,OAAO,OAAA,EAAS,MAAA,KAAW;AACvG,QAAA,IAAI;AACA,UAAA,IAAI,CAAC,KAAK,WAAA,EAAa;AACnB,YAAA,MAAM,IAAI,MAAM,0CAA0C,CAAA;AAAA,UAC9D;AACA,UAAA,MAAM,IAAA,GAAOA,uBAAA,CAAO,UAAA,CAAW,SAAS,CAAA;AACxC,UAAA,MAAM,UAAA,GAAa,IAAA,CAAK,WAAA,CAAY,gBAAA,CAAiB,QAAQ,CAAA;AAC7D,UAAA,UAAA,CAAW,GAAG,MAAA,EAAQ,CAAC,SAAc,IAAA,CAAK,MAAA,CAAO,IAAI,CAAC,CAAA;AACtD,UAAA,UAAA,CAAW,EAAA,CAAG,KAAA,EAAO,MAAM,OAAA,CAAQ,CAAA,EAAG,SAAS,CAAA,CAAA,EAAI,IAAA,CAAK,MAAA,CAAO,QAAQ,CAAC,CAAA,CAAE,CAAC,CAAA;AAC3E,UAAA,UAAA,CAAW,GAAG,OAAA,EAAS,CAAC,GAAA,KAAa,MAAA,CAAO,GAAG,CAAC,CAAA;AAAA,QACpD,SAAS,KAAA,EAAO;AACZ,UAAA,MAAA,CAAO,KAAK,CAAA;AAAA,QAChB;AAAA,MACJ,CAAC;AAAA,KACL;AAAA,EACJ;AACJ","file":"A-Crypto-Polyfill.js","sourcesContent":["import { A_Logger } from \"@adaas/a-utils/a-logger\";\nimport { A_CryptoPolyfillBase } from \"../base/A-Crypto-Polyfill.base\";\nimport crypto from 'crypto';\n\nexport class A_CryptoPolyfill extends A_CryptoPolyfillBase {\n    constructor(logger: A_Logger) {\n        super(logger);\n    }\n\n    protected async initImplementation(): Promise<void> {\n        this._crypto = {\n            createTextHash: (text: string, algorithm: string = 'sha384') => Promise.resolve(\n                `${algorithm}-${crypto.createHash(algorithm).update(text).digest('base64')}`\n            ),\n            createFileHash: (filePath: string, algorithm: string = 'sha384') => new Promise(async (resolve, reject) => {\n                try {\n                    if (!this._fsPolyfill) {\n                        throw new Error('FS polyfill is required for file hashing');\n                    }\n                    const hash = crypto.createHash(algorithm);\n                    const fileStream = this._fsPolyfill.createReadStream(filePath);\n                    fileStream.on('data', (data: any) => hash.update(data));\n                    fileStream.on('end', () => resolve(`${algorithm}-${hash.digest('base64')}`));\n                    fileStream.on('error', (err: any) => reject(err));\n                } catch (error) {\n                    reject(error);\n                }\n            })\n        };\n    }\n}"]}
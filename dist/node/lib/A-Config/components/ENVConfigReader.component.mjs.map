{"version":3,"sources":["../../../../../src/lib/A-Config/components/ENVConfigReader.component.ts"],"names":[],"mappings":";;;;;;;AAeO,IAAM,eAAA,GAAN,cAA8B,YAAA,CAAa;AAAA,EAM9C,MAAM,WAAA,CACkB,MAAA,EACE,QAAA,EACD,OAAA,EACvB;AACE,IAAA,MAAM,EAAA,GAAK,MAAM,QAAA,CAAS,EAAA,EAAG;AAE7B,IAAA,IAAI,EAAA,CAAG,WAAW,MAAM,CAAA;AACpB,MAAA,EAAA,CAAG,YAAA,CAAa,CAAA,EAAG,MAAA,CAAO,GAAA,CAAI,uBAAuB,CAAC,CAAA,KAAA,CAAA,EAAS,OAAO,CAAA,CAAE,KAAA,CAAM,IAAI,CAAA,CAAE,QAAQ,CAAA,IAAA,KAAQ;AAChG,QAAA,MAAM,CAAC,GAAA,EAAK,KAAK,CAAA,GAAI,IAAA,CAAK,MAAM,GAAG,CAAA;AACnC,QAAA,IAAI,OAAO,KAAA,EAAO;AACd,UAAA,aAAA,CAAc,IAAI,GAAA,CAAI,IAAA,EAAK,EAAG,KAAA,CAAM,MAAM,CAAA;AAAA,QAC9C;AAAA,MACJ,CAAC,CAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,mCAAmC,QAAA,EAA0B;AACzD,IAAA,OAAO,iBAAA,CAAkB,iBAAiB,QAAQ,CAAA;AAAA,EACtD;AAAA,EAGA,QAA2B,QAAA,EAA+B;AACtD,IAAA,OAAO,aAAA,CAAc,GAAA,CAAI,IAAA,CAAK,kCAAA,CAAmC,QAAQ,CAAC,CAAA;AAAA,EAC9E;AAAA,EAGA,MAAM,IAAA,CAAuB,SAAA,GAAsB,EAAC,EAA4B;AAC5E,IAAA,MAAM,YAAA,GAAe;AAAA,MACjB,GAAG,SAAA;AAAA,MACH,GAAG,cAAc,UAAA;AAAW,KAChC;AAEA,IAAA,MAAM,SAA8B,EAAC;AAErC,IAAA,YAAA,CAAa,OAAA,CAAQ,CAAC,QAAA,KAAa;AAC/B,MAAA,MAAA,CAAO,QAAQ,CAAA,GAAI,IAAA,CAAK,OAAA,CAAQ,QAAQ,CAAA;AAAA,IAC5C,CAAC,CAAA;AAED,IAAA,OAAO,MAAA;AAAA,EACX;AACJ;AA7CU,eAAA,CAAA;AAAA,EAHL,UAAU,IAAA,CAAK;AAAA,IACZ,MAAA,EAAQ,CAAC,4BAA4B;AAAA,GACxC,CAAA;AAAA,EAEI,4BAAS,QAAQ,CAAA,CAAA;AAAA,EACjB,4BAAS,UAAU,CAAA,CAAA;AAAA,EACnB,4BAAS,SAAS,CAAA;AAAA,CAAA,EATd,eAAA,CAMH,SAAA,EAAA,aAAA,EAAA,CAAA,CAAA;AANG,eAAA,GAAN,eAAA,CAAA;AAAA,EALN,QAAQ,SAAA,CAAU;AAAA,IACf,SAAA,EAAW,SAAA;AAAA,IACX,IAAA,EAAM,iBAAA;AAAA,IACN,WAAA,EAAa;AAAA,GAChB;AAAA,CAAA,EACY,eAAA,CAAA","file":"ENVConfigReader.component.mjs","sourcesContent":["import {\n    A_Concept, A_CONCEPT_ENV,\n    A_Feature,\n    A_FormatterHelper, A_Inject, A_TYPES__ConceptENVVariables\n} from \"@adaas/a-concept\";\nimport { ConfigReader } from \"./ConfigReader.component\";\nimport { A_Config } from \"../A-Config.context\";\nimport { A_Frame } from \"@adaas/a-frame\";\nimport { A_Polyfill } from \"@adaas/a-utils/a-polyfill\";\n\n@A_Frame.Component({\n    namespace: 'A-Utils',\n    name: 'ENVConfigReader',\n    description: 'Configuration reader that sources configuration data from environment variables. It supports loading variables from a .env file and maps them to the configuration context, making it suitable for applications running in diverse environments such as local development, staging, and production.'\n})\nexport class ENVConfigReader extends ConfigReader {\n\n\n    @A_Concept.Load({\n        before: ['ENVConfigReader.initialize']\n    })\n    async readEnvFile(\n        @A_Inject(A_Config) config: A_Config<A_TYPES__ConceptENVVariables>,\n        @A_Inject(A_Polyfill) polyfill: A_Polyfill,\n        @A_Inject(A_Feature) feature: A_Feature,\n    ) {\n        const fs = await polyfill.fs();\n\n        if (fs.existsSync('.env'))\n            fs.readFileSync(`${config.get('A_CONCEPT_ROOT_FOLDER')}/.env`, 'utf-8').split('\\n').forEach(line => {\n                const [key, value] = line.split('=');\n                if (key && value) {\n                    A_CONCEPT_ENV.set(key.trim(), value.trim());\n                }\n            });\n    }\n\n\n    /**\n     * Get the configuration property Name \n     * @param property \n     */\n    getConfigurationProperty_ENV_Alias(property: string): string {\n        return A_FormatterHelper.toUpperSnakeCase(property);\n    }\n\n\n    resolve<_ReturnType = any>(property: string): _ReturnType {\n        return A_CONCEPT_ENV.get(this.getConfigurationProperty_ENV_Alias(property)) as _ReturnType;\n    }\n\n\n    async read<T extends string>(variables: Array<T> = []): Promise<Record<T, any>> {\n        const allVariables = [\n            ...variables,\n            ...A_CONCEPT_ENV.getAllKeys()\n        ] as const;\n\n        const config: Record<string, any> = {};\n\n        allVariables.forEach((variable) => {\n            config[variable] = this.resolve(variable);\n        });\n\n        return config as Record<T, any>;\n    }\n} "]}